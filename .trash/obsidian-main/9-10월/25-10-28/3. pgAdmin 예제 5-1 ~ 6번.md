select * from stadium;
select * from schedule;
select * from team;
select * from player;


-- 005-1. 수원팀의 ID 는 ?
select team_id
	from team
	where region_name = '수원';

-- 005-2. 수원팀에서 성이 고씨이고 키가 170 이상인 선수를 출력하시오. (서브쿼리)
==\*서브쿼리 쓰는 이유!!!! 테이블이 서로 다른 경우
	그냥 team_name 이 수원인 경우로 쓰고싶지만, player 테이블에는 수원을 담고 있는  region_name 이 없기 때문임. region_name은 team 테이블에만 있고. player 테이블과 team 테이블이 연결될 수 있는 유일한 방법은  두 테이블 모두에 포함되어있는 team_id 로 연결하는 것이기 때문에 서브쿼리를 이용해서 team_id를 빼내는 것임

select * from player
	where team_id = (
		select team_id
		from team
		where region_name = '수원')		
	and player_name like '고%'
	and height >= 170;

						--이거는 안 되는거임
						select * from player
							where team_name = (
								select team_name
								from team
								where region = '수원')
							and player_name like '고%'
							and height >= 170;




-- 문제 6
-- 다음 조건을 만족하는 선수명단을 출력하시오
-- 소속팀이 삼성블루윙즈이거나
-- 드래곤즈에 소속된 선수들이어야 하고,
-- 포지션이 미드필더(MF:Midfielder)이어야 한다.
-- 키는 170 센티미터 이상이고 180 이하여야 한다.

- `team_name = '삼성블루윙즈' OR team_name = '드래곤즈'` 
	같다 `team_name IN ('삼성블루윙즈','드래곤즈')`

select player_name from player
	where team_id = (
    select team_id
    from team
    where team_name in ('삼성블루윙즈', '드래곤즈')
)
and position = 'MF'
and height between 170 and 180;


---------------
251029 수정 버전 (아침 자습)
select * from stadium;
select * from schedule;
select * from team;
select * from player;
-- 005-1. 수원팀의 ID 는 ?
select team_id
	from team
	where region_name = '수원';

-- 005-2. 수원팀에서 성이 고씨이고 키가 170 이상인 선수를 출력하시오. (서브쿼리) 
select * from player
	where team_id = (
		select team_id
		from team
		where region_name = '수원')		
	and player_name like '고%'
	and height >= 170;

-- 문제 6. 다음 조건을 만족하는 선수명단을 출력하시오
	-- 소속팀이 삼성블루윙즈이거나
	-- 드래곤즈에 소속된 선수들이어야 하고,
	-- 포지션이 미드필더(MF:Midfielder)이어야 한다.
	-- 키는 170 센티미터 이상이고 180 이하여야 한다.
select player_name
from player
where team_id in (
	select team_id
    from team
    where team_name in ('삼성블루윙즈', '드래곤즈')
	)
and position = 'MF'
and height between 170 and 180;



-----------------
수업 후 

select * from stadium;
select * from schedule;
select * from team;
select * from player;

-- 005-1. 수원팀의 ID 는 ?
select team_id
	from team
	where region_name = '수원';

-- 005-2. 수원팀에서 성이 고씨이고 키가 170 이상인 선수를 출력하시오.
--(서브쿼리) 
select * from player
	where team_id = (
		select team_id
		from team
		where region_name = '수원')		
	and player_name like '고%'
	and height >= 170;

--(조인) 수원팀에서 골키퍼(GK)의 이름을 모두 출력하시오.
select player_name
	from player p join team t --이너는 디폴트
	on p.team_id = t.team_id --on 은 join의
	where t.region_name = '수원' and p.position = 'GK';  


-- 문제 6. 다음 조건을 만족하는 선수명단을 출력하시오
	-- 소속팀이 삼성블루윙즈이거나
	-- 드래곤즈에 소속된 선수들이어야 하고,
	-- 포지션이 미드필더(MF:Midfielder)이어야 한다.
	-- 키는 170 센티미터 이상이고 180 이하여야 한다.
select player_name
	from player
	where team_id in (
		select team_id
		from team
		where team_name in ('삼성블루윙즈', '드래곤즈' )
	)
	and position = 'MF'
	and height between 170 and 180;
	