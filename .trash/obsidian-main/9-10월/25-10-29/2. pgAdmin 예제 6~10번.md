select * from stadium;
select * from schedule;
select * from team;
select * from player;

- || 쉬프트키 누르고 \ 두번 누르면 컬럼, 하나면 바
- p.position IS NULL OR p.position = ' '  >> 여기서 NULL과  ' '  를 둘다 쓰는 이유는, 스칼라 안에 스페이스바로 공백이 있을까봐. 혹시 모를 오류를 위해 둘 다 적어주는 게 좋음
- WHEN = IF 임. CASE 랑 END를 써줘야해.

--------------------------------------------

#--SQL_TEST_006
-- 수원팀 선수들 이름,
-- 키와 몸무게 리스트 (단위 cm 와 kg  삽입)
-- 키와 몸무게가 없으면 "0" 표시
-- 키 내림차순

SELECT 
    p.player_name  선수명,
    COALESCE(p.height, 0) || ' cm'  키,
    COALESCE(p.weight, 0) || ' kg'  몸무게
FROM player p JOIN team t
ON p.team_id = t.team_id
WHERE t.region_name = '수원'
ORDER BY p.height DESC Nulls Last;

null= 스칼라가 없다. COALESCE 앞에 점 없으니까 함수, 있으면 메서드 

---------------------------

#--SQL_TEST_007
-- 수원팀 선수들 이름,
-- 키와 몸무게 리스트 (단위 cm 와 kg  삽입)
-- 키와 몸무게가 없으면 "0" 표시
-- BMI지수
-- 키 내림차순

SELECT 
    p.player_name 선수명,
    COALESCE(p.height, 0),' cm' 키,
    COALESCE(p.weight, 0),' kg' 몸무게,
    CASE 
        WHEN p.height IS NULL OR p.height = 0 THEN 0
        WHEN p.weight IS NULL OR p.weight = 0 THEN 0
        ELSE ROUND((p.weight / POWER(p.height / 100, 2))::numeric, 0)
    END BMI
FROM player p JOIN team t
ON p.team_id = t.team_id    --using (team_id)
WHERE t.region_name = '수원'
ORDER BY p.height DESC nulls last;

------------------------------
#--SQL_TEST_008 OK

-- 수원팀 과 대전팀 선수들 중
-- 포지션이 GK 인 선수
-- 팀명, 사람명 오름차순

SELECT 
    t.team_name AS 팀명,
    p.player_name AS 선수명
FROM player p JOIN team t
ON p.team_id = t.team_id                        --using(team_id)
WHERE t.region_name IN ('수원', '대전')
  AND p.position = 'GK'
ORDER BY t.team_name ASC, p.player_name ASC;


------------------------------------------

#--SQL_TEST_009
-- 수원팀 과 대전팀 선수들 중 이
-- 키가 180 이상 183 이하인 선수들
-- 키, 팀명, 사람명 오름차순

SELECT 
    p.height 키,
    t.team_name 팀명,
    p.player_name 선수명
FROM player p JOIN team t 
    ON p.team_id = t.team_id
WHERE 
    t.region_name IN ('수원', '대전')
    AND p.height BETWEEN 180 AND 183
ORDER BY 
    p.height ASC,
    t.team_name COLLATE "ucs_basic" ASC,
    p.player_name COLLATE "ucs_basic" ASC;


------------------------------------

#--SOCCER_SQL_010
-- 모든 선수들 중
-- 포지션을 배정받지 못한 선수들의 팀과  이름
-- 팀명, 사람명 오름차순
SELECT 
    t.team_name 팀명,
    p.player_name 선수명
FROM player p JOIN team t 
    ON p.team_id = t.team_id
WHERE 
    p.position IS NULL
    OR p.position = ''
ORDER BY 
    t.team_name ASC, p.player_name ASC;



SELECT  
    (SELECT t.team_name  
     FROM team t  
     WHERE t.team_id = p.team_id) AS team_name,  
    p.player_names  
FROM player p  
WHERE p.position IS NULL OR p.position = ''  
ORDER BY team_name ASC, p.player_name ASC;