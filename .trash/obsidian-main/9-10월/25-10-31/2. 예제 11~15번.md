select * from stadium;
select * from schedule;
select * from team;
select * from player;

-- SOCCER_SQL_016
-- 평균키가 인천 유나이티스팀의 평균키  보다 작은 팀의
-- 팀ID, 팀명, 평균키 추출
SELECT 
    t.team_id 팀아이디,
    (t.region_name || ' ' || t.team_name) 팀명,
    ROUND(AVG(p.height), 2) 평균키
FROM player p JOIN team t
	ON p.team_id = t.team_id
GROUP BY t.team_id, t.team_name
HAVING AVG(p.height) < (
    SELECT AVG(p2.height)
    FROM player p2 JOIN team t2
	ON p2.team_id = t2.team_id
    WHERE t2.team_name = '유나이티드'
);

----------------------------------------

-- SOCCER_SQL_017
-- 포지션이 MF 인 선수들의
-- 소속팀명 및 선수명, 백넘버 출력
SELECT 
    t.team_name 소속팀명,
    p.player_name 선수명,
    p.back_no 백넘버
FROM player p JOIN team t
	ON p.team_id = t.team_id
WHERE p.position = 'MF'
ORDER BY t.team_name, p.player_name;

----------------------------------------

-- SOCCER_SQL_018
-- 가장 키큰 선수 5 추출, 오라클, 단 키 값이 없으면 제외
SELECT 
    player_name 선수명,
    height 키,
    team_id 팀ID
FROM player
	WHERE height IS NOT NULL
	ORDER BY height DESC
FETCH FIRST 5 ROWS ONLY;   -- 오라클 문법


------------------------------------

-- SOCCER_SQL_019
-- 선수 자신이 속한 팀의 평균키보다 작은 선수 정보 출력
SELECT 
    t.team_name 팀명,
	p.player_name 선수명,
	p.back_no 백넘버,
    p.height 선수키
FROM player p JOIN team t
	using(team_id)
WHERE p.height < (
    SELECT AVG(p2.height)
    FROM player p2
    WHERE p2.team_id = p.team_id
)
AND p.height IS NOT NULL;


-----------------------------------------

-- SOCCER_SQL_020
-- 2012년 5월 한달간 경기가 있는 경기장 조회
SELECT DISTINCT
    TO_DATE(sch.sche_date, 'YYYY-MM-DD') 날짜,
    s.stadium_name 경기장이름
FROM stadium s
JOIN schedule sch
  ON s.stadium_id = sch.stadium_id
WHERE TO_DATE(sch.sche_date, 'YYYY-MM-DD')
      BETWEEN DATE '2012-05-01' AND DATE '2012-05-31';




