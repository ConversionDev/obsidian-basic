from > where > select > order by


select * from stadium;
select * from schedule;
select * from team;
select * from player;
-- SOCCER_SQL_011
-- 팀과 스타디움을 조인하여
-- 팀이름, 스타디움 이름 출력
-- 연고지가 없는 팀은 팀명만 나오고, 
-- 스타디움은 20개 다 출력되고,
-- 스타디움을 왼쪽에 두고, 홈팀이 없으면 해당 팀명에 "홈팀이 없음"
-- 으로 출력하시오.
-- 참고로 팀은 총 15개임. 스타디움은 총 20개임.


SELECT 
    s.stadium_name  스타디움이름,
    coalesce(t.team_name, '홈팀이 없음')팀명
FROM stadium s LEFT JOIN team t 
    ON s.stadium_name = t.team_name;
	
--------------------------
select * from stadium;
select * from schedule;
select * from team;
select * from player;
-- SOCCER_SQL_012
-- 팀과 스타디움, 스케줄을 조인하여
-- 2012년 3월 17일에 열린 각 경기의
-- 팀이름, 스타디움, 어웨이팀 이름 출력
-- 다중테이블 join 을 찾아서 해결하시오.

SELECT 
    ht.team_name 홈팀이름,
    s.stadium_name 스타디움이름,
    wt.team_name 어웨이팀이름,
	sc.sche_date 경기일자
FROM schedule sc --180건
JOIN stadium s  --20건
	using(stadium_id)
JOIN team ht  --15건
    ON sc.hometeam_id = ht.team_id
JOIN team wt 
    ON sc.awayteam_id = wt.team_id
WHERE sc.sche_date = '2012-03-17';

--------------------------
select * from stadium;
select * from schedule;
select * from team;
select * from player;
-- SOCCER_SQL_013
-- 2012년 3월 17일 경기에
-- 포항 스틸러스 소속 골키퍼(GK)
-- 선수, 포지션,팀명 (연고지포함),
-- 스타디움, 경기날짜를 구하시오
-- 연고지와 팀이름은 간격을 띄우시오

SELECT 
    p.player_name 선수명,
    p.position 포지션,
    (t.region_name || ' ' || t.team_name) 팀명,
    s.stadium_name 스타디움,
    sc.sche_date 경기날짜
FROM player p JOIN team t
	Using(team_id)
 JOIN schedule sc 
        ON sc.hometeam_id = t.team_id 
        OR sc.awayteam_id = t.team_id
 JOIN stadium s
 	ON sc.stadium_id = s.stadium_id 
	 
 WHERE (t.region_name || ' ' || t.team_name) = '포항 스틸러스' --사실 포항 혹은 스틸러스로 해도 똑같은 결과인데, 혹시모를 오류 대비를 위해서 합친걸로 진행
    AND p.position = 'GK'
    AND sc.sche_date = '2012-03-17';

--------------------------
select * from stadium;
select * from schedule;
select * from team;
select * from player;
-- SOCCER_SQL_014
-- 홈팀이 3점이상 차이로 승리한 경기의
-- 경기장 이름, 경기 일정
-- 홈팀 이름과 원정팀 이름을
-- 구하시오
SELECT 
    s.stadium_name 경기장이름,
    sc.sche_date 경기일정,
    (ht.region_name || ' ' || ht.team_name) 홈팀,
    (wt.region_name || ' ' || wt.team_name) 원정팀,
    sc.home_score 홈팀점수,
    sc.away_score 원정팀점수
FROM schedule sc JOIN stadium s 
    USING(stadium_id)
JOIN team ht 
    ON sc.hometeam_id = ht.team_id
JOIN team wt 
    ON sc.awayteam_id = wt.team_id
WHERE (sc.home_score - sc.away_score) >= 3;

--------------------------
select * from stadium;
select * from schedule;
select * from team;
select * from player;
-- SOCCER_SQL_015
-- STADIUM 에 등록된 운동장 중에서
-- 홈팀이 없는 경기장까지 전부 나오도록
-- 카운트 값은 20

SELECT 
    s.stadium_id 경기장ID,
    s.stadium_name  경기장이름,
    s.seat_count  좌석수,
    s.hometeam_id  홈팀ID,
    t.e_team_name  홈팀영문이름
FROM stadium s LEFT JOIN team t 
    ON s.hometeam_id = t.team_id;

