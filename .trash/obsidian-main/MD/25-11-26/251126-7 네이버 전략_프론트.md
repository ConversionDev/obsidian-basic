# ë„¤ì´ë²„ ë¡œê·¸ì¸ êµ¬í˜„ ìš”ì•½

  

## âœ… ì™„ë£Œëœ ì‘ì—…

  

ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ê³¼ ë™ì¼í•œ ë°©ì‹ìœ¼ë¡œ ë„¤ì´ë²„ ë¡œê·¸ì¸ì„ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.

  

---

  

## ğŸ“ í”„ë¡ íŠ¸ì—”ë“œ êµ¬í˜„ ë‚´ìš©

  

### 1. ë¡œê·¸ì¸ í˜ì´ì§€ ìˆ˜ì • (`app/page.tsx`)

  

**ë³€ê²½ ì „:**

```typescript

const handleNaverLogin = async () => {

Â  // ë”ë¯¸ ë°ì´í„°ë¡œ ì§ì ‘ ìš”ì²­

Â  const res = await fetch("http://localhost:8080/api/auth/naver/login", {

Â  Â  method: "POST",

Â  Â  body: JSON.stringify({}),

Â  });

};

```

  

**ë³€ê²½ í›„:**

```typescript

const handleNaverLogin = async () => {

Â  // ë°±ì—”ë“œì—ì„œ ë„¤ì´ë²„ ì¸ì¦ URL ë°›ì•„ì˜¤ê¸° (ì¹´ì¹´ì˜¤ì™€ ë™ì¼)

Â  const res = await fetch("http://localhost:8080/api/auth/naver/auth-url", {

Â  Â  method: "GET",

Â  });

Â  const data = await res.json();

Â  if (data.authUrl) {

Â  Â  // ë„¤ì´ë²„ ì¸ì¦ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸

Â  Â  window.location.href = data.authUrl;

Â  }

};

```

  

### 2. ë„¤ì´ë²„ ì½œë°± í˜ì´ì§€ ìƒì„± (`app/auth/naver/callback/page.tsx`)

  

ì¹´ì¹´ì˜¤ ì½œë°± í˜ì´ì§€ì™€ ë™ì¼í•œ êµ¬ì¡°ë¡œ ìƒì„±:

  

```typescript

export default function NaverCallbackPage() {

Â  // ì¼€ì´ìŠ¤ 1: ë°±ì—”ë“œê°€ í† í°ì„ ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬í•œ ê²½ìš°

Â  const token = searchParams.get("token");

Â  if (token) {

Â  Â  localStorage.setItem("access_token", token);

Â  Â  router.push("/dashboard");

Â  }

Â  // ì¼€ì´ìŠ¤ 2: ì¸ê°€ ì½”ë“œë§Œ ì „ë‹¬ëœ ê²½ìš° (fallback)

Â  const code = searchParams.get("code");

Â  if (code) {

Â  Â  // ë°±ì—”ë“œë¡œ ì¸ê°€ ì½”ë“œ ì „ì†¡í•˜ì—¬ í† í° ë°›ê¸°

Â  Â  const res = await fetch("http://localhost:8080/api/auth/naver/login", {

Â  Â  Â  method: "POST",

Â  Â  Â  body: JSON.stringify({ code }),

Â  Â  });

Â  Â  // í† í° ì €ì¥ ë° ëŒ€ì‹œë³´ë“œ ì´ë™

Â  }

}

```

  

---

  

## ğŸ”„ ë„¤ì´ë²„ ë¡œê·¸ì¸ í”Œë¡œìš°

  

```

1. ì‚¬ìš©ì: ë„¤ì´ë²„ ë¡œê·¸ì¸ ë²„íŠ¼ í´ë¦­

Â  Â â†“

2. í”„ë¡ íŠ¸ì—”ë“œ: GET /api/auth/naver/auth-url

Â  Â â†“

3. ë°±ì—”ë“œ: ë„¤ì´ë²„ ì¸ì¦ URL ë°˜í™˜

Â  Â â†“

4. í”„ë¡ íŠ¸ì—”ë“œ: ë„¤ì´ë²„ ì¸ì¦ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸

Â  Â â†“

5. ì‚¬ìš©ì: ë„¤ì´ë²„ì—ì„œ ë¡œê·¸ì¸ ë° ë™ì˜

Â  Â â†“

6. ë„¤ì´ë²„: ë°±ì—”ë“œë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸

Â  Â http://localhost:8080/api/auth/naver/callback?code=ì¸ê°€ì½”ë“œ

Â  Â â†“

7. ë°±ì—”ë“œ: ì¸ê°€ ì½”ë“œë¡œ í† í° ë°œê¸‰ ë° ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ

Â  Â â†“

8. í”„ë¡ íŠ¸ì—”ë“œ: POST /api/auth/naver/login (ì¸ê°€ ì½”ë“œ ì „ì†¡)

Â  Â â†“

9. ë°±ì—”ë“œ: JWT í† í° ë°˜í™˜

Â  Â â†“

10. í”„ë¡ íŠ¸ì—”ë“œ: í† í° ì €ì¥ í›„ ëŒ€ì‹œë³´ë“œë¡œ ì´ë™

```

  

---

  

## ğŸ”§ ë°±ì—”ë“œì—ì„œ êµ¬í˜„í•´ì•¼ í•  ë‚´ìš©

  

### 1. NaverController.java

  

```java

@RestController

@RequestMapping("/naver")

public class NaverController {

Â  Â  // ë„¤ì´ë²„ ì¸ì¦ URL ìƒì„±

Â  Â  @GetMapping("/auth-url")

Â  Â  public ResponseEntity<Map<String, String>> getNaverAuthUrl() {

Â  Â  Â  Â  String authUrl = naverService.generateAuthUrl();

Â  Â  Â  Â  return ResponseEntity.ok(Map.of("authUrl", authUrl));

Â  Â  }

Â  Â  // ë„¤ì´ë²„ ë¡œê·¸ì¸ ì²˜ë¦¬ (ì¸ê°€ ì½”ë“œë¡œ í† í° ë°œê¸‰)

Â  Â  @PostMapping("/login")

Â  Â  public ResponseEntity<Map<String, Object>> naverLogin(@RequestBody Map<String, String> body) {

Â  Â  Â  Â  String code = body.get("code");

Â  Â  Â  Â  // 1. ì¸ê°€ ì½”ë“œë¡œ ë„¤ì´ë²„ ì•¡ì„¸ìŠ¤ í† í° ë°›ê¸°

Â  Â  Â  Â  // 2. ì•¡ì„¸ìŠ¤ í† í°ìœ¼ë¡œ ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ

Â  Â  Â  Â  // 3. JWT í† í° ìƒì„±

Â  Â  Â  Â  // 4. ì‘ë‹µ ë°˜í™˜

Â  Â  }

Â  Â  // ë„¤ì´ë²„ ì½œë°± ì²˜ë¦¬ (GET ìš”ì²­)

Â  Â  @GetMapping("/callback")

Â  Â  public ResponseEntity<Map<String, Object>> naverCallback(@RequestParam String code) {

Â  Â  Â  Â  // POST /loginê³¼ ë™ì¼í•œ ë¡œì§

Â  Â  }

}

```

  

### 2. NaverService.java

  

```java

@Service

public class NaverService {

Â  Â  // ë„¤ì´ë²„ ì¸ì¦ URL ìƒì„±

Â  Â  public String generateAuthUrl() {

Â  Â  Â  Â  // ë„¤ì´ë²„ Client IDëŠ” í™˜ê²½ ë³€ìˆ˜ì—ì„œ ê°€ì ¸ì˜´

Â  Â  Â  Â  // redirect_uri: http://localhost:8080/api/auth/naver/callback

Â  Â  Â  Â  return "https://nid.naver.com/oauth2.0/authorize"

Â  Â  Â  Â  Â  Â  + "?client_id=" + clientId

Â  Â  Â  Â  Â  Â  + "&redirect_uri=" + redirectUri

Â  Â  Â  Â  Â  Â  + "&response_type=code"

Â  Â  Â  Â  Â  Â  + "&state=" + state; // CSRF ë°©ì§€ìš© state

Â  Â  }

Â  Â  // ì¸ê°€ ì½”ë“œë¡œ ë„¤ì´ë²„ ì•¡ì„¸ìŠ¤ í† í° ë°›ê¸°

Â  Â  public String getAccessToken(String code, String state) {

Â  Â  Â  Â  // ë„¤ì´ë²„ API í˜¸ì¶œ: POST https://nid.naver.com/oauth2.0/token

Â  Â  }

Â  Â  // ì•¡ì„¸ìŠ¤ í† í°ìœ¼ë¡œ ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ

Â  Â  public NaverUserInfo getUserInfo(String accessToken) {

Â  Â  Â  Â  // ë„¤ì´ë²„ API í˜¸ì¶œ: GET https://openapi.naver.com/v1/nid/me

Â  Â  }

}

```

  

### 3. í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

  

```yaml

NAVER_CLIENT_ID: your_naver_client_id

NAVER_CLIENT_SECRET: your_naver_client_secret

NAVER_REDIRECT_URI: http://localhost:8080/api/auth/naver/callback

```

  

---

  

## ğŸ” ë„¤ì´ë²„ ê°œë°œì ì„¼í„° ì„¤ì •

  

### 1. ë„¤ì´ë²„ ê°œë°œì ì„¼í„° ì ‘ì†

- https://developers.naver.com/

- ì• í”Œë¦¬ì¼€ì´ì…˜ ë“±ë¡

  

### 2. API ì„¤ì •

1. **ì• í”Œë¦¬ì¼€ì´ì…˜ ì´ë¦„** ì…ë ¥

2. **ì‚¬ìš© API** ì„ íƒ: ë„¤ì´ë²„ ë¡œê·¸ì¸

3. **ì œê³µ ì •ë³´** ì„ íƒ:

Â  Â - íšŒì›ì´ë¦„

Â  Â - ì´ë©”ì¼ ì£¼ì†Œ

Â  Â - í”„ë¡œí•„ ì‚¬ì§„ (ì„ íƒ)

  

### 3. ì„œë¹„ìŠ¤ í™˜ê²½ ë“±ë¡

1. **ì„œë¹„ìŠ¤ URL**: `http://localhost:8080`

2. **Callback URL**: `http://localhost:8080/api/auth/naver/callback`

Â  Â - âš ï¸ **ì¤‘ìš”**: ë°±ì—”ë“œ ì½œë°± ì£¼ì†Œë¥¼ ë“±ë¡í•©ë‹ˆë‹¤!

  

### 4. Client ID ë° Client Secret í™•ì¸

- ì• í”Œë¦¬ì¼€ì´ì…˜ ì •ë³´ì—ì„œ í™•ì¸

- ë°±ì—”ë“œ í™˜ê²½ ë³€ìˆ˜ì— ì„¤ì •

  

---

  

## ğŸ“Š ì¹´ì¹´ì˜¤ vs ë„¤ì´ë²„ ë¹„êµ

  

| í•­ëª© | ì¹´ì¹´ì˜¤ | ë„¤ì´ë²„ |

|------|--------|--------|

| ì¸ì¦ URL | `https://kauth.kakao.com/oauth/authorize` | `https://nid.naver.com/oauth2.0/authorize` |

| í† í° ë°œê¸‰ | `https://kauth.kakao.com/oauth/token` | `https://nid.naver.com/oauth2.0/token` |

| ì‚¬ìš©ì ì •ë³´ | `https://kapi.kakao.com/v2/user/me` | `https://openapi.naver.com/v1/nid/me` |

| í•„ìˆ˜ íŒŒë¼ë¯¸í„° | `client_id`, `redirect_uri`, `response_type` | `client_id`, `redirect_uri`, `response_type`, `state` |

| ì¶”ê°€ ì¸ì¦ | REST API í‚¤ë§Œ í•„ìš” | Client ID + Client Secret í•„ìš” |

| State íŒŒë¼ë¯¸í„° | ì„ íƒ | **í•„ìˆ˜** (CSRF ë°©ì§€) |

  

---

  

## âš ï¸ ë„¤ì´ë²„ ë¡œê·¸ì¸ ì£¼ì˜ì‚¬í•­

  

### 1. State íŒŒë¼ë¯¸í„° (CSRF ë°©ì§€)

ë„¤ì´ë²„ëŠ” **state íŒŒë¼ë¯¸í„°ê°€ í•„ìˆ˜**ì…ë‹ˆë‹¤.

  

```java

// ì¸ì¦ URL ìƒì„± ì‹œ

String state = UUID.randomUUID().toString();

session.setAttribute("oauth_state", state); // ì„¸ì…˜ì— ì €ì¥

  

// ì½œë°± ì²˜ë¦¬ ì‹œ

String receivedState = request.getParameter("state");

String sessionState = session.getAttribute("oauth_state");

if (!receivedState.equals(sessionState)) {

Â  Â  throw new SecurityException("Invalid state parameter");

}

```

  

### 2. Client Secret

ë„¤ì´ë²„ëŠ” í† í° ë°œê¸‰ ì‹œ **Client Secretì´ í•„ìˆ˜**ì…ë‹ˆë‹¤.

  

```java

// í† í° ìš”ì²­ ì‹œ

POST https://nid.naver.com/oauth2.0/token

{

Â  Â  "grant_type": "authorization_code",

Â  Â  "client_id": "...",

Â  Â  "client_secret": "...", // í•„ìˆ˜!

Â  Â  "code": "...",

Â  Â  "state": "..."

}

```

  

### 3. ì‚¬ìš©ì ì •ë³´ ì‘ë‹µ í˜•ì‹

ë„¤ì´ë²„ëŠ” ì‚¬ìš©ì ì •ë³´ê°€ `response` ê°ì²´ ì•ˆì— ìˆìŠµë‹ˆë‹¤.

  

```json

{

Â  "resultcode": "00",

Â  "message": "success",

Â  "response": {

Â  Â  "id": "...",

Â  Â  "email": "...",

Â  Â  "name": "..."

Â  }

}

```

  

---

  

## âœ… í”„ë¡ íŠ¸ì—”ë“œ ì™„ë£Œ ì²´í¬ë¦¬ìŠ¤íŠ¸

  

- âœ… ë„¤ì´ë²„ ë¡œê·¸ì¸ ë²„íŠ¼ í´ë¦­ ì‹œ ë°±ì—”ë“œì—ì„œ ì¸ì¦ URL ë°›ì•„ì˜¤ê¸°

- âœ… ë„¤ì´ë²„ ì¸ì¦ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸

- âœ… ë„¤ì´ë²„ ì½œë°± í˜ì´ì§€ ìƒì„± (`/auth/naver/callback`)

- âœ… ì¸ê°€ ì½”ë“œ ì²˜ë¦¬ ë¡œì§

- âœ… JWT í† í° ì €ì¥ (localStorage)

- âœ… ëŒ€ì‹œë³´ë“œë¡œ ì´ë™

- âœ… ì—ëŸ¬ ì²˜ë¦¬ ë° ì‚¬ìš©ì í”¼ë“œë°±

  

---

  

## ğŸš€ ë°±ì—”ë“œì—ì„œ êµ¬í˜„í•´ì•¼ í•  ê²ƒ

  

### í•„ìˆ˜ êµ¬í˜„

1. âœ… NaverController ìƒì„±

Â  Â - `GET /naver/auth-url`: ë„¤ì´ë²„ ì¸ì¦ URL ìƒì„±

Â  Â - `POST /naver/login`: ì¸ê°€ ì½”ë“œë¡œ JWT í† í° ë°œê¸‰

Â  Â - `GET /naver/callback`: ë„¤ì´ë²„ ì½œë°± ì²˜ë¦¬

  

2. âœ… NaverService ìƒì„±

Â  Â - `generateAuthUrl()`: ë„¤ì´ë²„ ì¸ì¦ URL ìƒì„± (state í¬í•¨)

Â  Â - `getAccessToken()`: ì¸ê°€ ì½”ë“œë¡œ ì•¡ì„¸ìŠ¤ í† í° ë°›ê¸°

Â  Â - `getUserInfo()`: ì•¡ì„¸ìŠ¤ í† í°ìœ¼ë¡œ ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ

  

3. âœ… DTO í´ë˜ìŠ¤ ìƒì„±

Â  Â - `NaverTokenResponse`: í† í° ì‘ë‹µ DTO

Â  Â - `NaverUserInfo`: ì‚¬ìš©ì ì •ë³´ DTO

  

4. âœ… í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

Â  Â - `NAVER_CLIENT_ID`

Â  Â - `NAVER_CLIENT_SECRET`

Â  Â - `NAVER_REDIRECT_URI`

  

5. âœ… State ê´€ë¦¬

Â  Â - ì„¸ì…˜ ë˜ëŠ” Redisì— state ì €ì¥

Â  Â - ì½œë°± ì‹œ state ê²€ì¦

  

---

  

## ğŸ¯ ë‹¤ìŒ ë‹¨ê³„

  

1. **ë°±ì—”ë“œ êµ¬í˜„**

Â  Â - NaverController, NaverService ìƒì„±

Â  Â - State íŒŒë¼ë¯¸í„° ê´€ë¦¬ ë¡œì§ ì¶”ê°€

Â  Â - ë„¤ì´ë²„ API ì—°ë™

  

2. **ë„¤ì´ë²„ ê°œë°œì ì„¼í„° ì„¤ì •**

Â  Â - ì• í”Œë¦¬ì¼€ì´ì…˜ ë“±ë¡

Â  Â - Callback URL ì„¤ì •

Â  Â - Client ID/Secret í™•ì¸

  

3. **í…ŒìŠ¤íŠ¸**

Â  Â - ë„¤ì´ë²„ ë¡œê·¸ì¸ í”Œë¡œìš° í…ŒìŠ¤íŠ¸

Â  Â - JWT í† í° ë°œê¸‰ í™•ì¸

Â  Â - ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ í™•ì¸

  

---

  

**ì‘ì„±ì¼**: 2025ë…„ 1ì›”

**ìƒíƒœ**: í”„ë¡ íŠ¸ì—”ë“œ ì™„ë£Œ âœ… / ë°±ì—”ë“œ ëŒ€ê¸° ì¤‘