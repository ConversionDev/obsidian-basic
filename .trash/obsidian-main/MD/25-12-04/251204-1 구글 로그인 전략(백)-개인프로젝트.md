# êµ¬ê¸€ ë¡œê·¸ì¸ êµ¬í˜„ ê°€ì´ë“œ

  

ë‹¤ë¥¸ í”„ë¡œì íŠ¸ì—ì„œ êµ¬ê¸€ OAuth 2.0 ë¡œê·¸ì¸ì„ êµ¬í˜„í•˜ê¸° ìœ„í•œ ì™„ì „í•œ ì „ëµ ë° êµ¬í˜„ ê°€ì´ë“œì…ë‹ˆë‹¤.

  

---

  

## ğŸ“‹ ëª©ì°¨

  

1. [ì•„í‚¤í…ì²˜ ê°œìš”](#ì•„í‚¤í…ì²˜-ê°œìš”)

2. [ì‚¬ì „ ì¤€ë¹„](#ì‚¬ì „-ì¤€ë¹„)

3. [ë°±ì—”ë“œ êµ¬í˜„](#ë°±ì—”ë“œ-êµ¬í˜„)

4. [í™˜ê²½ ì„¤ì •](#í™˜ê²½-ì„¤ì •)

5. [API ì—”ë“œí¬ì¸íŠ¸](#api-ì—”ë“œí¬ì¸íŠ¸)

6. [í”„ë¡ íŠ¸ì—”ë“œ ì—°ë™](#í”„ë¡ íŠ¸ì—”ë“œ-ì—°ë™)

7. [íŠ¸ëŸ¬ë¸”ìŠˆíŒ…](#íŠ¸ëŸ¬ë¸”ìŠˆíŒ…)

  

---

  

## ğŸ—ï¸ ì•„í‚¤í…ì²˜ ê°œìš”

  

### OAuth 2.0 ì¸ì¦ íë¦„

  

```

í´ë¼ì´ì–¸íŠ¸ Â  Â  Â  Â  Â  Â  Â  Â ë°±ì—”ë“œ Â  Â  Â  Â  Â  Â  Â  Â  Â Google OAuth

Â  Â | Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â | Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  |

Â  Â | Â 1. ì¸ì¦ URL ìš”ì²­ Â  Â | Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  |

Â  Â |--------------------->| Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  |

Â  Â | Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â | Â 2. ì¸ì¦ URL ìƒì„± Â  Â  Â  |

Â  Â |<---------------------| Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  |

Â  Â | Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â | Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  |

Â  Â | Â 3. ì‚¬ìš©ì ë¦¬ë””ë ‰ì…˜ Â | Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  |

Â  Â |------------------------------------------------>|

Â  Â | Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â | Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  |

Â  Â | Â 4. ì¸ì¦ ì™„ë£Œ í›„ ì½œë°± (code + state) Â  Â  Â  Â  Â  |

Â  Â |<------------------------------------------------|

Â  Â | Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â | Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  |

Â  Â | Â 5. code + state ì „ë‹¬| Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  |

Â  Â |--------------------->| Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  |

Â  Â | Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â | Â 6. ì•¡ì„¸ìŠ¤ í† í° ìš”ì²­ Â  Â |

Â  Â | Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â |------------------------>|

Â  Â | Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â | Â 7. ì•¡ì„¸ìŠ¤ í† í° ë°˜í™˜ Â  Â |

Â  Â | Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â |<------------------------|

Â  Â | Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â | Â 8. ì‚¬ìš©ì ì •ë³´ ìš”ì²­ Â  Â |

Â  Â | Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â |------------------------>|

Â  Â | Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â | Â 9. ì‚¬ìš©ì ì •ë³´ ë°˜í™˜ Â  Â |

Â  Â | Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â |<------------------------|

Â  Â | Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â | Â 10. JWT í† í° ìƒì„± Â  Â  Â |

Â  Â | Â 11. JWT + ì‚¬ìš©ì ì •ë³´| Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  |

Â  Â |<---------------------| Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  |

```

  

### í•µì‹¬ ì»´í¬ë„ŒíŠ¸

  

1. **GoogleAuthService**: OAuth 2.0 ì¸ì¦ ë¡œì§ ì²˜ë¦¬

2. **GoogleController**: API ì—”ë“œí¬ì¸íŠ¸ ì œê³µ

3. **DTO í´ë˜ìŠ¤**: Google API ì‘ë‹µ ë§¤í•‘

4. **RestTemplate**: HTTP í†µì‹  ì²˜ë¦¬

5. **JWT Provider**: ìì²´ JWT í† í° ë°œê¸‰ (ì„ íƒì‚¬í•­)

  

---

  

## ğŸ”§ ì‚¬ì „ ì¤€ë¹„

  

### 1. Google Cloud Console ì„¤ì •

  

#### 1.1 í”„ë¡œì íŠ¸ ìƒì„±

1. [Google Cloud Console](https://console.cloud.google.com/) ì ‘ì†

2. ìƒˆ í”„ë¡œì íŠ¸ ìƒì„±

  

#### 1.2 OAuth 2.0 í´ë¼ì´ì–¸íŠ¸ ID ìƒì„±

1. **APIs & Services** â†’ **Credentials**

2. **CREATE CREDENTIALS** â†’ **OAuth client ID**

3. **Application type**: Web application

4. **Authorized redirect URIs** ì¶”ê°€:

Â  Â ```

Â  Â http://localhost:8080/api/auth/google/callback

Â  Â https://yourdomain.com/api/auth/google/callback

Â  Â ```

Â  Â âš ï¸ **ì¤‘ìš”**: URIëŠ” ì •í™•íˆ ì¼ì¹˜í•´ì•¼ í•¨ (ìŠ¬ë˜ì‹œ í¬í•¨)

  

#### 1.3 ìê²©ì¦ëª… ì €ì¥

- **Client ID**: `GOOGLE_CLIENT_ID`

- **Client Secret**: `GOOGLE_CLIENT_SECRET`

  

---

  

## ğŸ’» ë°±ì—”ë“œ êµ¬í˜„

  

### ë””ë ‰í† ë¦¬ êµ¬ì¡°

  

```

src/main/java/com/yourpackage/

â”œâ”€â”€ google/

â”‚ Â  â”œâ”€â”€ GoogleAuthService.java Â  Â  Â # OAuth ì¸ì¦ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§

â”‚ Â  â”œâ”€â”€ GoogleController.java Â  Â  Â  # REST API ì»¨íŠ¸ë¡¤ëŸ¬

â”‚ Â  â””â”€â”€ dto/

â”‚ Â  Â  Â  â”œâ”€â”€ GoogleTokenResponse.java Â  Â # í† í° ì‘ë‹µ DTO

â”‚ Â  Â  Â  â””â”€â”€ GoogleUserInfo.java Â  Â  Â  Â  # ì‚¬ìš©ì ì •ë³´ DTO

â”œâ”€â”€ config/

â”‚ Â  â””â”€â”€ RestTemplateConfig.java Â  Â  # RestTemplate ë¹ˆ ì„¤ì •

â””â”€â”€ jwt/ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  # JWT ê´€ë ¨ (ì„ íƒì‚¬í•­)

Â  Â  â””â”€â”€ JwtTokenProvider.java

```

  

### 1. DTO í´ë˜ìŠ¤

  

#### GoogleTokenResponse.java

```java

package com.yourpackage.google.dto;

  

import com.fasterxml.jackson.annotation.JsonProperty;

  

public class GoogleTokenResponse {

  

Â  Â  @JsonProperty("access_token")

Â  Â  private String accessToken;

  

Â  Â  @JsonProperty("token_type")

Â  Â  private String tokenType;

  

Â  Â  @JsonProperty("refresh_token")

Â  Â  private String refreshToken;

  

Â  Â  @JsonProperty("expires_in")

Â  Â  private Integer expiresIn;

  

Â  Â  @JsonProperty("scope")

Â  Â  private String scope;

  

Â  Â  // Getters and Setters

Â  Â  public String getAccessToken() {

Â  Â  Â  Â  return accessToken;

Â  Â  }

  

Â  Â  public void setAccessToken(String accessToken) {

Â  Â  Â  Â  this.accessToken = accessToken;

Â  Â  }

  

Â  Â  public String getTokenType() {

Â  Â  Â  Â  return tokenType;

Â  Â  }

  

Â  Â  public void setTokenType(String tokenType) {

Â  Â  Â  Â  this.tokenType = tokenType;

Â  Â  }

  

Â  Â  public String getRefreshToken() {

Â  Â  Â  Â  return refreshToken;

Â  Â  }

  

Â  Â  public void setRefreshToken(String refreshToken) {

Â  Â  Â  Â  this.refreshToken = refreshToken;

Â  Â  }

  

Â  Â  public Integer getExpiresIn() {

Â  Â  Â  Â  return expiresIn;

Â  Â  }

  

Â  Â  public void setExpiresIn(Integer expiresIn) {

Â  Â  Â  Â  this.expiresIn = expiresIn;

Â  Â  }

  

Â  Â  public String getScope() {

Â  Â  Â  Â  return scope;

Â  Â  }

  

Â  Â  public void setScope(String scope) {

Â  Â  Â  Â  this.scope = scope;

Â  Â  }

}

```

  

#### GoogleUserInfo.java

```java

package com.yourpackage.google.dto;

  

import com.fasterxml.jackson.annotation.JsonProperty;

  

public class GoogleUserInfo {

  

Â  Â  @JsonProperty("id")

Â  Â  private String id;

  

Â  Â  @JsonProperty("email")

Â  Â  private String email;

  

Â  Â  @JsonProperty("verified_email")

Â  Â  private Boolean verifiedEmail;

  

Â  Â  @JsonProperty("name")

Â  Â  private String name;

  

Â  Â  @JsonProperty("given_name")

Â  Â  private String givenName;

  

Â  Â  @JsonProperty("family_name")

Â  Â  private String familyName;

  

Â  Â  @JsonProperty("picture")

Â  Â  private String picture;

  

Â  Â  @JsonProperty("locale")

Â  Â  private String locale;

  

Â  Â  // Getters and Setters

Â  Â  public String getId() {

Â  Â  Â  Â  return id;

Â  Â  }

  

Â  Â  public void setId(String id) {

Â  Â  Â  Â  this.id = id;

Â  Â  }

  

Â  Â  public String getEmail() {

Â  Â  Â  Â  return email;

Â  Â  }

  

Â  Â  public void setEmail(String email) {

Â  Â  Â  Â  this.email = email;

Â  Â  }

  

Â  Â  public Boolean getVerifiedEmail() {

Â  Â  Â  Â  return verifiedEmail;

Â  Â  }

  

Â  Â  public void setVerifiedEmail(Boolean verifiedEmail) {

Â  Â  Â  Â  this.verifiedEmail = verifiedEmail;

Â  Â  }

  

Â  Â  public String getName() {

Â  Â  Â  Â  return name;

Â  Â  }

  

Â  Â  public void setName(String name) {

Â  Â  Â  Â  this.name = name;

Â  Â  }

  

Â  Â  public String getGivenName() {

Â  Â  Â  Â  return givenName;

Â  Â  }

  

Â  Â  public void setGivenName(String givenName) {

Â  Â  Â  Â  this.givenName = givenName;

Â  Â  }

  

Â  Â  public String getFamilyName() {

Â  Â  Â  Â  return familyName;

Â  Â  }

  

Â  Â  public void setFamilyName(String familyName) {

Â  Â  Â  Â  this.familyName = familyName;

Â  Â  }

  

Â  Â  public String getPicture() {

Â  Â  Â  Â  return picture;

Â  Â  }

  

Â  Â  public void setPicture(String picture) {

Â  Â  Â  Â  this.picture = picture;

Â  Â  }

  

Â  Â  public String getLocale() {

Â  Â  Â  Â  return locale;

Â  Â  }

  

Â  Â  public void setLocale(String locale) {

Â  Â  Â  Â  this.locale = locale;

Â  Â  }

}

```

  

### 2. GoogleAuthService.java

  

```java

package com.yourpackage.google;

  

import com.yourpackage.google.dto.GoogleTokenResponse;

import com.yourpackage.google.dto.GoogleUserInfo;

import org.springframework.beans.factory.annotation.Value;

import org.springframework.http.*;

import org.springframework.stereotype.Service;

import org.springframework.util.LinkedMultiValueMap;

import org.springframework.util.MultiValueMap;

import org.springframework.web.client.RestTemplate;

  

import java.net.URLEncoder;

import java.nio.charset.StandardCharsets;

import java.util.UUID;

  

@Service

public class GoogleAuthService {

  

Â  Â  private final RestTemplate restTemplate;

  

Â  Â  @Value("${google.client-id}")

Â  Â  private String clientId;

  

Â  Â  @Value("${google.client-secret}")

Â  Â  private String clientSecret;

  

Â  Â  @Value("${google.redirect-uri}")

Â  Â  private String redirectUri;

  

Â  Â  private static final String GOOGLE_AUTH_URL = "https://accounts.google.com/o/oauth2/v2/auth";

Â  Â  private static final String GOOGLE_TOKEN_URL = "https://oauth2.googleapis.com/token";

Â  Â  private static final String GOOGLE_USER_INFO_URL = "https://www.googleapis.com/oauth2/v2/userinfo";

  

Â  Â  public GoogleAuthService(RestTemplate restTemplate) {

Â  Â  Â  Â  this.restTemplate = restTemplate;

Â  Â  }

  

Â  Â  /**

Â  Â  Â * êµ¬ê¸€ ì¸ì¦ URL ìƒì„±

Â  Â  Â * @return êµ¬ê¸€ ì¸ì¦ URL

Â  Â  Â */

Â  Â  public String generateAuthUrl() {

Â  Â  Â  Â  // State íŒŒë¼ë¯¸í„° ìƒì„± (CSRF ë°©ì§€)

Â  Â  Â  Â  String state = UUID.randomUUID().toString();

Â  Â  Â  Â  try {

Â  Â  Â  Â  Â  Â  // URL ì¸ì½”ë”© ì ìš©

Â  Â  Â  Â  Â  Â  String encodedRedirectUri = URLEncoder.encode(redirectUri, StandardCharsets.UTF_8.toString());

Â  Â  Â  Â  Â  Â  String encodedScope = URLEncoder.encode("profile email", StandardCharsets.UTF_8.toString());

Â  Â  Â  Â  Â  Â  String authUrl = GOOGLE_AUTH_URL +

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "?client_id=" + clientId +

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "&redirect_uri=" + encodedRedirectUri +

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "&response_type=code" +

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "&scope=" + encodedScope +

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "&state=" + state +

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "&access_type=offline" +

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "&prompt=consent";

Â  Â  Â  Â  Â  Â  return authUrl;

Â  Â  Â  Â  } catch (Exception e) {

Â  Â  Â  Â  Â  Â  throw new RuntimeException("êµ¬ê¸€ ì¸ì¦ URL ìƒì„± ì‹¤íŒ¨", e);

Â  Â  Â  Â  }

Â  Â  }

  

Â  Â  /**

Â  Â  Â * êµ¬ê¸€ ì•¡ì„¸ìŠ¤ í† í° ìš”ì²­

Â  Â  Â * @param code ì¸ê°€ ì½”ë“œ

Â  Â  Â * @param state State íŒŒë¼ë¯¸í„°

Â  Â  Â * @return êµ¬ê¸€ ì•¡ì„¸ìŠ¤ í† í°

Â  Â  Â */

Â  Â  public String getAccessToken(String code, String state) {

Â  Â  Â  Â  // ìš”ì²­ í—¤ë” ì„¤ì •

Â  Â  Â  Â  HttpHeaders headers = new HttpHeaders();

Â  Â  Â  Â  headers.setContentType(MediaType.APPLICATION_FORM_URLENCODED);

  

Â  Â  Â  Â  // ìš”ì²­ ë°”ë”” ì„¤ì •

Â  Â  Â  Â  MultiValueMap<String, String> params = new LinkedMultiValueMap<>();

Â  Â  Â  Â  params.add("grant_type", "authorization_code");

Â  Â  Â  Â  params.add("client_id", clientId);

Â  Â  Â  Â  params.add("client_secret", clientSecret);

Â  Â  Â  Â  params.add("code", code);

Â  Â  Â  Â  params.add("redirect_uri", redirectUri);

  

Â  Â  Â  Â  HttpEntity<MultiValueMap<String, String>> request = new HttpEntity<>(params, headers);

  

Â  Â  Â  Â  try {

Â  Â  Â  Â  Â  Â  // êµ¬ê¸€ í† í° API í˜¸ì¶œ

Â  Â  Â  Â  Â  Â  ResponseEntity<GoogleTokenResponse> response = restTemplate.exchange(

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  GOOGLE_TOKEN_URL,

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  HttpMethod.POST,

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  request,

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  GoogleTokenResponse.class

Â  Â  Â  Â  Â  Â  );

  

Â  Â  Â  Â  Â  Â  GoogleTokenResponse tokenResponse = response.getBody();

Â  Â  Â  Â  Â  Â  if (tokenResponse != null && tokenResponse.getAccessToken() != null) {

Â  Â  Â  Â  Â  Â  Â  Â  return tokenResponse.getAccessToken();

Â  Â  Â  Â  Â  Â  } else {

Â  Â  Â  Â  Â  Â  Â  Â  throw new RuntimeException("êµ¬ê¸€ ì•¡ì„¸ìŠ¤ í† í° ë°œê¸‰ ì‹¤íŒ¨");

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  } catch (Exception e) {

Â  Â  Â  Â  Â  Â  throw new RuntimeException("êµ¬ê¸€ ì•¡ì„¸ìŠ¤ í† í° ìš”ì²­ ì‹¤íŒ¨", e);

Â  Â  Â  Â  }

Â  Â  }

  

Â  Â  /**

Â  Â  Â * êµ¬ê¸€ ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ

Â  Â  Â * @param accessToken êµ¬ê¸€ ì•¡ì„¸ìŠ¤ í† í°

Â  Â  Â * @return êµ¬ê¸€ ì‚¬ìš©ì ì •ë³´

Â  Â  Â */

Â  Â  public GoogleUserInfo getUserInfo(String accessToken) {

Â  Â  Â  Â  // ìš”ì²­ í—¤ë” ì„¤ì •

Â  Â  Â  Â  HttpHeaders headers = new HttpHeaders();

Â  Â  Â  Â  headers.setBearerAuth(accessToken);

  

Â  Â  Â  Â  HttpEntity<String> request = new HttpEntity<>(headers);

  

Â  Â  Â  Â  try {

Â  Â  Â  Â  Â  Â  // êµ¬ê¸€ ì‚¬ìš©ì ì •ë³´ API í˜¸ì¶œ

Â  Â  Â  Â  Â  Â  ResponseEntity<GoogleUserInfo> response = restTemplate.exchange(

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  GOOGLE_USER_INFO_URL,

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  HttpMethod.GET,

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  request,

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  GoogleUserInfo.class

Â  Â  Â  Â  Â  Â  );

  

Â  Â  Â  Â  Â  Â  GoogleUserInfo userInfo = response.getBody();

Â  Â  Â  Â  Â  Â  if (userInfo != null && userInfo.getId() != null) {

Â  Â  Â  Â  Â  Â  Â  Â  return userInfo;

Â  Â  Â  Â  Â  Â  } else {

Â  Â  Â  Â  Â  Â  Â  Â  throw new RuntimeException("êµ¬ê¸€ ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ ì‹¤íŒ¨");

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  } catch (Exception e) {

Â  Â  Â  Â  Â  Â  throw new RuntimeException("êµ¬ê¸€ ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ ì‹¤íŒ¨", e);

Â  Â  Â  Â  }

Â  Â  }

}

```

  

### 3. GoogleController.java

  

```java

package com.yourpackage.google;

  

import com.yourpackage.google.dto.GoogleUserInfo;

import org.springframework.http.HttpStatus;

import org.springframework.http.ResponseEntity;

import org.springframework.web.bind.annotation.*;

  

import java.util.HashMap;

import java.util.Map;

  

@RestController

@RequestMapping("/api/auth/google")

public class GoogleController {

  

Â  Â  private final GoogleAuthService googleAuthService;

  

Â  Â  public GoogleController(GoogleAuthService googleAuthService) {

Â  Â  Â  Â  this.googleAuthService = googleAuthService;

Â  Â  }

  

Â  Â  /**

Â  Â  Â * êµ¬ê¸€ ì¸ì¦ URL ìƒì„±

Â  Â  Â * @return { "authUrl": "https://accounts.google.com/o/oauth2/v2/auth?..." }

Â  Â  Â */

Â  Â  @GetMapping("/auth-url")

Â  Â  public ResponseEntity<Map<String, String>> getGoogleAuthUrl() {

Â  Â  Â  Â  String authUrl = googleAuthService.generateAuthUrl();

Â  Â  Â  Â  Map<String, String> response = new HashMap<>();

Â  Â  Â  Â  response.put("authUrl", authUrl);

Â  Â  Â  Â  return ResponseEntity.ok(response);

Â  Â  }

  

Â  Â  /**

Â  Â  Â * êµ¬ê¸€ ë¡œê·¸ì¸ (ì¸ê°€ ì½”ë“œë¡œ ì²˜ë¦¬)

Â  Â  Â * @param body { "code": "êµ¬ê¸€_ì¸ê°€_ì½”ë“œ", "state": "state_ê°’" }

Â  Â  Â * @return JWT í† í° + ì‚¬ìš©ì ì •ë³´

Â  Â  Â */

Â  Â  @PostMapping("/login")

Â  Â  public ResponseEntity<Map<String, Object>> googleLogin(@RequestBody Map<String, String> body) {

Â  Â  Â  Â  try {

Â  Â  Â  Â  Â  Â  // 1. ì¸ê°€ ì½”ë“œ ë° state ì¶”ì¶œ

Â  Â  Â  Â  Â  Â  String code = body.get("code");

Â  Â  Â  Â  Â  Â  String state = body.get("state");

Â  Â  Â  Â  Â  Â  if (code == null || code.isEmpty()) {

Â  Â  Â  Â  Â  Â  Â  Â  return ResponseEntity.badRequest().body(Map.of(

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "success", false,

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "message", "ì¸ê°€ ì½”ë“œê°€ í•„ìš”í•©ë‹ˆë‹¤."

Â  Â  Â  Â  Â  Â  Â  Â  ));

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  if (state == null || state.isEmpty()) {

Â  Â  Â  Â  Â  Â  Â  Â  return ResponseEntity.badRequest().body(Map.of(

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "success", false,

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "message", "State íŒŒë¼ë¯¸í„°ê°€ í•„ìš”í•©ë‹ˆë‹¤."

Â  Â  Â  Â  Â  Â  Â  Â  ));

Â  Â  Â  Â  Â  Â  }

  

Â  Â  Â  Â  Â  Â  // 2. êµ¬ê¸€ ì•¡ì„¸ìŠ¤ í† í° ìš”ì²­

Â  Â  Â  Â  Â  Â  String googleAccessToken = googleAuthService.getAccessToken(code, state);

  

Â  Â  Â  Â  Â  Â  // 3. êµ¬ê¸€ ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ

Â  Â  Â  Â  Â  Â  GoogleUserInfo googleUserInfo = googleAuthService.getUserInfo(googleAccessToken);

  

Â  Â  Â  Â  Â  Â  // 4. ì‘ë‹µ ìƒì„± (JWT ë°œê¸‰ì€ í”„ë¡œì íŠ¸ì— ë§ê²Œ êµ¬í˜„)

Â  Â  Â  Â  Â  Â  Map<String, Object> response = new HashMap<>();

Â  Â  Â  Â  Â  Â  response.put("success", true);

Â  Â  Â  Â  Â  Â  response.put("message", "êµ¬ê¸€ ë¡œê·¸ì¸ ì„±ê³µ");

Â  Â  Â  Â  Â  Â  Map<String, Object> user = new HashMap<>();

Â  Â  Â  Â  Â  Â  user.put("googleId", googleUserInfo.getId());

Â  Â  Â  Â  Â  Â  user.put("email", googleUserInfo.getEmail());

Â  Â  Â  Â  Â  Â  user.put("name", googleUserInfo.getName());

Â  Â  Â  Â  Â  Â  user.put("givenName", googleUserInfo.getGivenName());

Â  Â  Â  Â  Â  Â  user.put("familyName", googleUserInfo.getFamilyName());

Â  Â  Â  Â  Â  Â  user.put("picture", googleUserInfo.getPicture());

Â  Â  Â  Â  Â  Â  response.put("user", user);

  

Â  Â  Â  Â  Â  Â  // TODO: JWT í† í° ë°œê¸‰ ë¡œì§ ì¶”ê°€

Â  Â  Â  Â  Â  Â  // String jwtToken = jwtTokenProvider.generateToken(claims);

Â  Â  Â  Â  Â  Â  // response.put("token", jwtToken);

Â  Â  Â  Â  Â  Â  // response.put("token_type", "Bearer");

  

Â  Â  Â  Â  Â  Â  return ResponseEntity.ok(response);

  

Â  Â  Â  Â  } catch (Exception e) {

Â  Â  Â  Â  Â  Â  return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).body(Map.of(

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "success", false,

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "message", "êµ¬ê¸€ ë¡œê·¸ì¸ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: " + e.getMessage()

Â  Â  Â  Â  Â  Â  ));

Â  Â  Â  Â  }

Â  Â  }

  

Â  Â  /**

Â  Â  Â * êµ¬ê¸€ ì½œë°± (GET ìš”ì²­)

Â  Â  Â * @param code êµ¬ê¸€ ì¸ê°€ ì½”ë“œ

Â  Â  Â * @param state State íŒŒë¼ë¯¸í„°

Â  Â  Â * @return JWT í† í° + ì‚¬ìš©ì ì •ë³´

Â  Â  Â */

Â  Â  @GetMapping("/callback")

Â  Â  public ResponseEntity<Map<String, Object>> googleCallback(

Â  Â  Â  Â  Â  Â  @RequestParam String code,

Â  Â  Â  Â  Â  Â  @RequestParam String state) {

Â  Â  Â  Â  // POST /loginê³¼ ë™ì¼í•œ ë¡œì§ ìˆ˜í–‰

Â  Â  Â  Â  Map<String, String> body = new HashMap<>();

Â  Â  Â  Â  body.put("code", code);

Â  Â  Â  Â  body.put("state", state);

Â  Â  Â  Â  return googleLogin(body);

Â  Â  }

}

```

  

### 4. RestTemplateConfig.java

  

```java

package com.yourpackage.config;

  

import org.springframework.context.annotation.Bean;

import org.springframework.context.annotation.Configuration;

import org.springframework.web.client.RestTemplate;

  

@Configuration

public class RestTemplateConfig {

  

Â  Â  @Bean

Â  Â  public RestTemplate restTemplate() {

Â  Â  Â  Â  return new RestTemplate();

Â  Â  }

}

```

  

---

  

## âš™ï¸ í™˜ê²½ ì„¤ì •

  

### 1. application.yaml

  

```yaml

spring:

Â  application:

Â  Â  name: your-service-name

  

server:

Â  port: 8080

  

# êµ¬ê¸€ OAuth ì„¤ì •

google:

Â  client-id: ${GOOGLE_CLIENT_ID}

Â  client-secret: ${GOOGLE_CLIENT_SECRET}

Â  redirect-uri: ${GOOGLE_REDIRECT_URI}

  

# JWT ì„¤ì • (ì„ íƒì‚¬í•­)

jwt:

Â  secret: ${JWT_SECRET:your-secret-key-must-be-at-least-256-bits-long-for-hs256}

Â  expiration: 86400000 Â # 24ì‹œê°„ (ë°€ë¦¬ì´ˆ)

```

  

### 2. .env íŒŒì¼

  

```env

# êµ¬ê¸€ OAuth ì„¤ì •

GOOGLE_CLIENT_ID=your-google-client-id.apps.googleusercontent.com

GOOGLE_CLIENT_SECRET=your-google-client-secret

GOOGLE_REDIRECT_URI=http://localhost:8080/api/auth/google/callback

  

# JWT ì„¤ì • (ì„ íƒì‚¬í•­)

JWT_SECRET=your-super-secret-jwt-key-at-least-256-bits-long

```

  

âš ï¸ **ì£¼ì˜ì‚¬í•­**:

- `.env` íŒŒì¼ì€ `.gitignore`ì— ì¶”ê°€

- í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œëŠ” í™˜ê²½ ë³€ìˆ˜ë¡œ ê´€ë¦¬

  

### 3. build.gradle (Gradle) ë˜ëŠ” pom.xml (Maven)

  

#### Gradle

```gradle

dependencies {

Â  Â  implementation 'org.springframework.boot:spring-boot-starter-web'

Â  Â  implementation 'com.fasterxml.jackson.core:jackson-databind'

Â  Â  // JWT (ì„ íƒì‚¬í•­)

Â  Â  implementation 'io.jsonwebtoken:jjwt-api:0.11.5'

Â  Â  runtimeOnly 'io.jsonwebtoken:jjwt-impl:0.11.5'

Â  Â  runtimeOnly 'io.jsonwebtoken:jjwt-jackson:0.11.5'

}

```

  

#### Maven

```xml

<dependencies>

Â  Â  <dependency>

Â  Â  Â  Â  <groupId>org.springframework.boot</groupId>

Â  Â  Â  Â  <artifactId>spring-boot-starter-web</artifactId>

Â  Â  </dependency>

Â  Â  <dependency>

Â  Â  Â  Â  <groupId>com.fasterxml.jackson.core</groupId>

Â  Â  Â  Â  <artifactId>jackson-databind</artifactId>

Â  Â  </dependency>

Â  Â  <!-- JWT (ì„ íƒì‚¬í•­) -->

Â  Â  <dependency>

Â  Â  Â  Â  <groupId>io.jsonwebtoken</groupId>

Â  Â  Â  Â  <artifactId>jjwt-api</artifactId>

Â  Â  Â  Â  <version>0.11.5</version>

Â  Â  </dependency>

Â  Â  <dependency>

Â  Â  Â  Â  <groupId>io.jsonwebtoken</groupId>

Â  Â  Â  Â  <artifactId>jjwt-impl</artifactId>

Â  Â  Â  Â  <version>0.11.5</version>

Â  Â  Â  Â  <scope>runtime</scope>

Â  Â  </dependency>

Â  Â  <dependency>

Â  Â  Â  Â  <groupId>io.jsonwebtoken</groupId>

Â  Â  Â  Â  <artifactId>jjwt-jackson</artifactId>

Â  Â  Â  Â  <version>0.11.5</version>

Â  Â  Â  Â  <scope>runtime</scope>

Â  Â  </dependency>

</dependencies>

```

  

---

  

## ğŸ”Œ API ì—”ë“œí¬ì¸íŠ¸

  

### 1. ì¸ì¦ URL ìƒì„±

  

**Endpoint**: `GET /api/auth/google/auth-url`

  

**Response**:

```json

{

Â  "authUrl": "https://accounts.google.com/o/oauth2/v2/auth?client_id=...&redirect_uri=..."

}

```

  

**ì‚¬ìš© ì˜ˆì‹œ**:

```bash

curl http://localhost:8080/api/auth/google/auth-url

```

  

### 2. ë¡œê·¸ì¸ ì²˜ë¦¬ (POST)

  

**Endpoint**: `POST /api/auth/google/login`

  

**Request Body**:

```json

{

Â  "code": "êµ¬ê¸€_ì¸ê°€_ì½”ë“œ",

Â  "state": "state_ê°’"

}

```

  

**Response (ì„±ê³µ)**:

```json

{

Â  "success": true,

Â  "message": "êµ¬ê¸€ ë¡œê·¸ì¸ ì„±ê³µ",

Â  "token": "eyJhbGciOiJIUzI1NiIs...",

Â  "token_type": "Bearer",

Â  "user": {

Â  Â  "googleId": "1234567890",

Â  Â  "email": "user@example.com",

Â  Â  "name": "í™ê¸¸ë™",

Â  Â  "givenName": "ê¸¸ë™",

Â  Â  "familyName": "í™",

Â  Â  "picture": "https://lh3.googleusercontent.com/..."

Â  }

}

```

  

**Response (ì‹¤íŒ¨)**:

```json

{

Â  "success": false,

Â  "message": "ì¸ê°€ ì½”ë“œê°€ í•„ìš”í•©ë‹ˆë‹¤."

}

```

  

### 3. ì½œë°± ì²˜ë¦¬ (GET)

  

**Endpoint**: `GET /api/auth/google/callback?code=...&state=...`

  

**Query Parameters**:

- `code`: êµ¬ê¸€ ì¸ê°€ ì½”ë“œ

- `state`: State íŒŒë¼ë¯¸í„°

  

**Response**: POST /loginê³¼ ë™ì¼

  

---

  

## ğŸŒ í”„ë¡ íŠ¸ì—”ë“œ ì—°ë™

  

### React/Next.js ì˜ˆì‹œ

  

```typescript

// 1. êµ¬ê¸€ ë¡œê·¸ì¸ ë²„íŠ¼ í´ë¦­ ì‹œ

const handleGoogleLogin = async () => {

Â  try {

Â  Â  // ë°±ì—”ë“œì—ì„œ ì¸ì¦ URL ë°›ê¸°

Â  Â  const response = await fetch('http://localhost:8080/api/auth/google/auth-url');

Â  Â  const data = await response.json();

Â  Â  // êµ¬ê¸€ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë””ë ‰ì…˜

Â  Â  window.location.href = data.authUrl;

Â  } catch (error) {

Â  Â  console.error('êµ¬ê¸€ ë¡œê·¸ì¸ ì‹¤íŒ¨:', error);

Â  }

};

  

// 2. ì½œë°± í˜ì´ì§€ì—ì„œ code ì²˜ë¦¬

// pages/auth/google/callback.tsx ë˜ëŠ” app/auth/google/callback/page.tsx

const GoogleCallback = () => {

Â  useEffect(() => {

Â  Â  const handleCallback = async () => {

Â  Â  Â  // URLì—ì„œ codeì™€ state ì¶”ì¶œ

Â  Â  Â  const urlParams = new URLSearchParams(window.location.search);

Â  Â  Â  const code = urlParams.get('code');

Â  Â  Â  const state = urlParams.get('state');

Â  Â  Â  if (code && state) {

Â  Â  Â  Â  try {

Â  Â  Â  Â  Â  // ë°±ì—”ë“œë¡œ code ì „ì†¡

Â  Â  Â  Â  Â  const response = await fetch('http://localhost:8080/api/auth/google/login', {

Â  Â  Â  Â  Â  Â  method: 'POST',

Â  Â  Â  Â  Â  Â  headers: {

Â  Â  Â  Â  Â  Â  Â  'Content-Type': 'application/json',

Â  Â  Â  Â  Â  Â  },

Â  Â  Â  Â  Â  Â  body: JSON.stringify({ code, state }),

Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  const data = await response.json();

Â  Â  Â  Â  Â  if (data.success) {

Â  Â  Â  Â  Â  Â  // JWT í† í° ì €ì¥

Â  Â  Â  Â  Â  Â  localStorage.setItem('token', data.token);

Â  Â  Â  Â  Â  Â  localStorage.setItem('user', JSON.stringify(data.user));

Â  Â  Â  Â  Â  Â  // ë©”ì¸ í˜ì´ì§€ë¡œ ë¦¬ë””ë ‰ì…˜

Â  Â  Â  Â  Â  Â  window.location.href = '/';

Â  Â  Â  Â  Â  }

Â  Â  Â  Â  } catch (error) {

Â  Â  Â  Â  Â  console.error('ë¡œê·¸ì¸ ì²˜ë¦¬ ì‹¤íŒ¨:', error);

Â  Â  Â  Â  }

Â  Â  Â  }

Â  Â  };

Â  Â  handleCallback();

Â  }, []);

Â  return <div>ë¡œê·¸ì¸ ì²˜ë¦¬ ì¤‘...</div>;

};

```

  

### í™˜ê²½ ë³€ìˆ˜ ì„¤ì • (í”„ë¡ íŠ¸ì—”ë“œ)

  

```env

# .env.local

NEXT_PUBLIC_API_URL=http://localhost:8080

```

  

---

  

## ğŸ› íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

  

### 1. redirect_uri_mismatch ì˜¤ë¥˜

  

**ì¦ìƒ**: Google ë¡œê·¸ì¸ í˜ì´ì§€ì—ì„œ "ë¦¬ë””ë ‰ì…˜ URI ë¶ˆì¼ì¹˜" ì˜¤ë¥˜

  

**ì›ì¸**:

- Google Cloud Consoleì— ë“±ë¡ëœ URIì™€ ì‹¤ì œ ìš”ì²­ URIê°€ ë‹¤ë¦„

- URI ëì˜ ìŠ¬ë˜ì‹œ(`/`) ì°¨ì´

- í”„ë¡œí† ì½œ ì°¨ì´ (`http` vs `https`)

  

**í•´ê²° ë°©ë²•**:

1. Google Cloud Console â†’ OAuth 2.0 í´ë¼ì´ì–¸íŠ¸ ID

2. "ìŠ¹ì¸ëœ ë¦¬ë””ë ‰ì…˜ URI"ì— ì •í™•íˆ ë“±ë¡:

Â  Â ```

Â  Â http://localhost:8080/api/auth/google/callback

Â  Â ```

3. `.env` íŒŒì¼ì˜ `GOOGLE_REDIRECT_URI` í™•ì¸

4. ì½”ë“œì—ì„œ ìƒì„±ë˜ëŠ” URI í™•ì¸:

Â  Â ```bash

Â  Â # ì‹¤ì œ ìƒì„±ë˜ëŠ” URI í™•ì¸

Â  Â curl http://localhost:8080/api/auth/google/auth-url

Â  Â ```

  

### 2. CORS ì˜¤ë¥˜

  

**ì¦ìƒ**: í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ë°±ì—”ë“œ API í˜¸ì¶œ ì‹œ CORS ì˜¤ë¥˜

  

**í•´ê²° ë°©ë²•**:

  

```java

@Configuration

public class WebConfig implements WebMvcConfigurer {

Â  Â  @Override

Â  Â  public void addCorsMappings(CorsRegistry registry) {

Â  Â  Â  Â  registry.addMapping("/api/**")

Â  Â  Â  Â  Â  Â  Â  Â  .allowedOrigins("http://localhost:3000") Â // í”„ë¡ íŠ¸ì—”ë“œ URL

Â  Â  Â  Â  Â  Â  Â  Â  .allowedMethods("GET", "POST", "PUT", "DELETE", "OPTIONS")

Â  Â  Â  Â  Â  Â  Â  Â  .allowedHeaders("*")

Â  Â  Â  Â  Â  Â  Â  Â  .allowCredentials(true);

Â  Â  }

}

```

  

### 3. ì•¡ì„¸ìŠ¤ í† í° ìš”ì²­ ì‹¤íŒ¨

  

**ì¦ìƒ**: 400 Bad Request ë˜ëŠ” 401 Unauthorized

  

**ì›ì¸**:

- Client ID/Secretì´ ì˜ëª»ë¨

- ì¸ê°€ ì½”ë“œê°€ ë§Œë£Œë¨ (5ë¶„ ì œí•œ)

- Redirect URIê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŒ

  

**í•´ê²° ë°©ë²•**:

1. `.env` íŒŒì¼ì˜ ìê²©ì¦ëª… í™•ì¸

2. ì¸ê°€ ì½”ë“œë¥¼ ë°›ì€ í›„ ì¦‰ì‹œ í† í° ìš”ì²­

3. ë¡œê·¸ í™•ì¸:

Â  Â ```java

Â  Â System.out.println("Client ID: " + clientId);

Â  Â System.out.println("Redirect URI: " + redirectUri);

Â  Â ```

  

### 4. ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ ì‹¤íŒ¨

  

**ì¦ìƒ**: 401 Unauthorized

  

**ì›ì¸**:

- ì•¡ì„¸ìŠ¤ í† í°ì´ ìœ íš¨í•˜ì§€ ì•ŠìŒ

- Bearer í† í° í˜•ì‹ ì˜¤ë¥˜

  

**í•´ê²° ë°©ë²•**:

```java

// ì˜¬ë°”ë¥¸ Bearer í† í° ì„¤ì •

headers.setBearerAuth(accessToken);

  

// ë˜ëŠ”

headers.set("Authorization", "Bearer " + accessToken);

```

  

### 5. State íŒŒë¼ë¯¸í„° ê²€ì¦

  

**ë³´ì•ˆ ê°•í™”ë¥¼ ìœ„í•œ State ê²€ì¦** (ì„ íƒì‚¬í•­):

  

```java

// ì„¸ì…˜ ë˜ëŠ” Redisì— state ì €ì¥

public String generateAuthUrl(HttpSession session) {

Â  Â  String state = UUID.randomUUID().toString();

Â  Â  session.setAttribute("oauth_state", state);

Â  Â  // ... URL ìƒì„±

}

  

// ì½œë°±ì—ì„œ ê²€ì¦

public ResponseEntity<?> googleLogin(

Â  Â  Â  Â  @RequestBody Map<String, String> body,

Â  Â  Â  Â  HttpSession session) {

Â  Â  String receivedState = body.get("state");

Â  Â  String savedState = (String) session.getAttribute("oauth_state");

Â  Â  if (!receivedState.equals(savedState)) {

Â  Â  Â  Â  return ResponseEntity.badRequest().body(Map.of(

Â  Â  Â  Â  Â  Â  "success", false,

Â  Â  Â  Â  Â  Â  "message", "Invalid state parameter"

Â  Â  Â  Â  ));

Â  Â  }

Â  Â  // ... ë‚˜ë¨¸ì§€ ë¡œì§

}

```

  

---

  

## ğŸ“ ì²´í¬ë¦¬ìŠ¤íŠ¸

  

### êµ¬í˜„ ì „

- [ ] Google Cloud Consoleì—ì„œ í”„ë¡œì íŠ¸ ìƒì„±

- [ ] OAuth 2.0 í´ë¼ì´ì–¸íŠ¸ ID ìƒì„±

- [ ] Redirect URI ë“±ë¡

- [ ] Client ID, Client Secret í™•ë³´

  

### ë°±ì—”ë“œ êµ¬í˜„

- [ ] DTO í´ë˜ìŠ¤ ìƒì„± (GoogleTokenResponse, GoogleUserInfo)

- [ ] GoogleAuthService êµ¬í˜„

- [ ] GoogleController êµ¬í˜„

- [ ] RestTemplateConfig ì„¤ì •

- [ ] application.yaml ì„¤ì •

- [ ] .env íŒŒì¼ ìƒì„± ë° ìê²©ì¦ëª… ì…ë ¥

  

### í…ŒìŠ¤íŠ¸

- [ ] ì¸ì¦ URL ìƒì„± í…ŒìŠ¤íŠ¸

- [ ] êµ¬ê¸€ ë¡œê·¸ì¸ í”Œë¡œìš° ì „ì²´ í…ŒìŠ¤íŠ¸

- [ ] ì½œë°± ì²˜ë¦¬ í…ŒìŠ¤íŠ¸

- [ ] ì—ëŸ¬ í•¸ë“¤ë§ í…ŒìŠ¤íŠ¸

  

### í”„ë¡ íŠ¸ì—”ë“œ ì—°ë™

- [ ] ë¡œê·¸ì¸ ë²„íŠ¼ êµ¬í˜„

- [ ] ì½œë°± í˜ì´ì§€ êµ¬í˜„

- [ ] JWT í† í° ì €ì¥ ë° ê´€ë¦¬

- [ ] CORS ì„¤ì • í™•ì¸

  

### ë°°í¬

- [ ] í”„ë¡œë•ì…˜ Redirect URI ë“±ë¡

- [ ] í™˜ê²½ ë³€ìˆ˜ ì„¤ì • (ì‹œí¬ë¦¿ ê´€ë¦¬)

- [ ] HTTPS ì ìš©

- [ ] ë³´ì•ˆ ê²€í†  (State ê²€ì¦, CSRF ë°©ì§€)

  

---

  

## ğŸ”’ ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

  

1. **State íŒŒë¼ë¯¸í„°**: CSRF ê³µê²© ë°©ì§€ë¥¼ ìœ„í•´ í•„ìˆ˜

2. **HTTPS**: í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œëŠ” ë°˜ë“œì‹œ HTTPS ì‚¬ìš©

3. **í™˜ê²½ ë³€ìˆ˜**: Client Secretì€ ì ˆëŒ€ ì½”ë“œì— í•˜ë“œì½”ë”©í•˜ì§€ ì•ŠìŒ

4. **í† í° ì €ì¥**: JWTëŠ” HttpOnly ì¿ í‚¤ ì‚¬ìš© ê¶Œì¥

5. **ì—ëŸ¬ ë©”ì‹œì§€**: ìƒì„¸í•œ ì—ëŸ¬ ì •ë³´ ë…¸ì¶œ ê¸ˆì§€

  

---

  

## ğŸ“š ì°¸ê³  ìë£Œ

  

- [Google OAuth 2.0 ê³µì‹ ë¬¸ì„œ](https://developers.google.com/identity/protocols/oauth2)

- [Spring RestTemplate ë¬¸ì„œ](https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/client/RestTemplate.html)

- [RFC 6749 - OAuth 2.0](https://datatracker.ietf.org/doc/html/rfc6749)

  

---

  

## ğŸ’¡ í™•ì¥ ì•„ì´ë””ì–´

  

### 1. ë‹¤ë¥¸ ì†Œì…œ ë¡œê·¸ì¸ ì¶”ê°€

- ë™ì¼í•œ íŒ¨í„´ìœ¼ë¡œ Kakao, Naver, Facebook ë“± ì¶”ê°€ ê°€ëŠ¥

- ì¸í„°í˜ì´ìŠ¤ë¥¼ í™œìš©í•œ ì¶”ìƒí™”:

Â  ```java

Â  public interface OAuthService {

Â  Â  Â  String generateAuthUrl();

Â  Â  Â  String getAccessToken(String code, String state);

Â  Â  Â  UserInfo getUserInfo(String accessToken);

Â  }

Â  ```

  

### 2. ì‚¬ìš©ì DB ì—°ë™

- êµ¬ê¸€ IDë¡œ ì‚¬ìš©ì ì¡°íšŒ/ìƒì„±

- í”„ë¡œí•„ ì •ë³´ ë™ê¸°í™”

  

### 3. Refresh Token í™œìš©

- ì¥ê¸° ë¡œê·¸ì¸ ìœ ì§€

- ì•¡ì„¸ìŠ¤ í† í° ìë™ ê°±ì‹ 

  

### 4. ë©€í‹° OAuth Provider

- í•˜ë‚˜ì˜ ì´ë©”ì¼ë¡œ ì—¬ëŸ¬ ì†Œì…œ ê³„ì • ì—°ë™

- Primary OAuth Provider ì„¤ì •

  

---

  

ì´ ê°€ì´ë“œë¥¼ í™œìš©í•˜ì—¬ ë‹¤ë¥¸ í”„ë¡œì íŠ¸ì—ì„œë„ êµ¬ê¸€ ë¡œê·¸ì¸ì„ ì‰½ê²Œ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

í”„ë¡œì íŠ¸ ìš”êµ¬ì‚¬í•­ì— ë§ê²Œ ì»¤ìŠ¤í„°ë§ˆì´ì§•í•˜ì—¬ ì‚¬ìš©í•˜ì„¸ìš”.