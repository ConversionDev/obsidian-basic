ìœ ë ˆì¹´ë¥¼ ì œê±°í•˜ê³  Spring Cloud Gatewayë¡œ ì „í™˜í•˜ëŠ” ì „ëµì„ ì•Œë ¤ë“œë¦¬ê² ìŠµë‹ˆë‹¤. ë¨¼ì € í˜„ì¬ êµ¬ì¡°ë¥¼ íŒŒì•…í•´ë³´ê² ìŠµë‹ˆë‹¤.

[8 tools called]

ì™„ë²½í•©ë‹ˆë‹¤! í˜„ì¬ êµ¬ì¡°ë¥¼ íŒŒì•…í–ˆìŠµë‹ˆë‹¤. **ìœ ë ˆì¹´ë¥¼ ì œê±°í•˜ê³  Spring Cloud Gatewayë¡œ ì „í™˜í•˜ëŠ” ì „ëµ**ì„ ì•Œë ¤ë“œë¦¬ê² ìŠµë‹ˆë‹¤.

## ğŸ“‹ í˜„ì¬ ì•„í‚¤í…ì²˜ ë¶„ì„

í˜„ì¬ ì‹œìŠ¤í…œì€:
- **Eureka Server** (ì„œë¹„ìŠ¤ ë””ìŠ¤ì»¤ë²„ë¦¬)
- **Discovery Server** (Spring Cloud Gateway + Eureka Client)
- **6ê°œì˜ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤** (ëª¨ë‘ Eureka Clientë¡œ ë“±ë¡)

êµ¬ì¡°ë¡œ ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

---

## ğŸ¯ ì „í™˜ ì „ëµ (Eureka ì œê±° â†’ Gateway ì§ì ‘ ë¼ìš°íŒ…)

### **1ë‹¨ê³„: ì•„í‚¤í…ì²˜ ë³€ê²½ ë°©í–¥**

#### **Before (í˜„ì¬)**
```
Client â†’ Gateway (Discovery) â†’ Eureka â†’ Services
         â†“ (lb://SERVICE_NAME)
         Eurekaì—ì„œ ì„œë¹„ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ ì¡°íšŒ
```

#### **After (ëª©í‘œ)**
```
Client â†’ Gateway â†’ Services (ì§ì ‘ URL)
         â†“ (http://service-name:port)
         Docker ë„¤íŠ¸ì›Œí¬ DNS í™œìš©
```

---

### **2ë‹¨ê³„: êµ¬ì²´ì ì¸ ì‘ì—… ìˆœì„œ**

#### **Phase 1: Gateway ì„¤ì • ë³€ê²½** âœ…
1. **`discovery/application.yaml` ìˆ˜ì •**
   - `uri: lb://SERVICE_NAME` â†’ `uri: http://service-name:8080`
   - Eureka í´ë¼ì´ì–¸íŠ¸ ì„¤ì • ì œê±°
   - Docker ë„¤íŠ¸ì›Œí¬ DNS ì´ë¦„ ì‚¬ìš©

2. **`discovery/build.gradle` ìˆ˜ì •**
   - Eureka Client ì˜ì¡´ì„± ì œê±°
   ```gradle
   // ì œê±°: implementation 'org.springframework.cloud:spring-cloud-starter-netflix-eureka-client'
   ```

3. **`DiscoveryApplication.java` ìˆ˜ì •**
   - `@EnableEurekaClient` ë˜ëŠ” `@EnableDiscoveryClient` ì–´ë…¸í…Œì´ì…˜ ì œê±°

#### **Phase 2: ê° ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ìˆ˜ì •** ğŸ”§
ê° ì„œë¹„ìŠ¤ (common, environment, social, governance, soccer, user)ì—ì„œ:

1. **`build.gradle` ìˆ˜ì •**
   - Eureka Client ì˜ì¡´ì„± ì œê±°

2. **`application.yaml` ìˆ˜ì •**
   - `eureka.client` ì„¤ì • ì „ì²´ ì œê±°

3. **Application í´ë˜ìŠ¤ ìˆ˜ì •**
   - `@EnableEurekaClient` ì œê±°

#### **Phase 3: Eureka Server ì œê±°** ğŸ—‘ï¸
1. **`docker-compose.yaml` ìˆ˜ì •**
   - `eureka-server` ì„œë¹„ìŠ¤ ì œê±°
   - ëª¨ë“  ì„œë¹„ìŠ¤ì˜ `depends_on`ì—ì„œ `eureka-server` ì œê±°
   - ëª¨ë“  ì„œë¹„ìŠ¤ì˜ `EUREKA_SERVER_URL` í™˜ê²½ë³€ìˆ˜ ì œê±°

2. **`server/eureka` ë””ë ‰í† ë¦¬ ì‚­ì œ**

3. **`config-server` í™˜ê²½ë³€ìˆ˜ ì •ë¦¬**
   - `EUREKA_SERVER_URL` ì œê±°

#### **Phase 4: Config Server ê²€í† ** ğŸ“
- Config Serverë„ Eureka Clientì¸ì§€ í™•ì¸ í•„ìš”
- í•„ìš”ì‹œ ë™ì¼í•˜ê²Œ Eureka ì˜ì¡´ì„± ì œê±°

---

### **3ë‹¨ê³„: Gateway ë¼ìš°íŒ… ì˜ˆì‹œ (ë³€ê²½ í›„)**

```yaml
spring:
  cloud:
    gateway:
      routes:
        - id: soccer-service
          uri: http://soccer:8080  # â† lb://SOCCERì—ì„œ ë³€ê²½
          predicates:
            - Path=/api/soccer/**
          filters:
            - StripPrefix=2
            # ... ë‚˜ë¨¸ì§€ í•„í„° ìœ ì§€
        
        - id: user-service
          uri: http://user:8080  # â† lb://userì—ì„œ ë³€ê²½
          predicates:
            - Path=/api/user/**
          # ...
```

---

### **4ë‹¨ê³„: ì¥ë‹¨ì  ë¶„ì„**

#### **ì¥ì ** âœ…
1. **ë‹¨ìˆœì„±**: Eureka ì„œë²„ ê´€ë¦¬ ë¶ˆí•„ìš”
2. **ë¦¬ì†ŒìŠ¤ ì ˆì•½**: Eureka ì„œë²„ ì»¨í…Œì´ë„ˆ ì œê±°
3. **ë¹ ë¥¸ ì‹œì‘**: ì„œë¹„ìŠ¤ ë“±ë¡ ëŒ€ê¸° ì‹œê°„ ì—†ìŒ
4. **ëª…í™•í•œ ë¼ìš°íŒ…**: ì •ì  URLë¡œ ë””ë²„ê¹… ìš©ì´

#### **ë‹¨ì ** âš ï¸
1. **ë™ì  ìŠ¤ì¼€ì¼ë§ ë¶ˆê°€**: ì„œë¹„ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ ìë™ ë°œê²¬ ë¶ˆê°€
2. **ë¡œë“œ ë°¸ëŸ°ì‹± ì œí•œ**: ì—¬ëŸ¬ ì¸ìŠ¤í„´ìŠ¤ ì‹¤í–‰ ì‹œ ìˆ˜ë™ ì„¤ì • í•„ìš”
3. **ìœ ì—°ì„± ê°ì†Œ**: ì„œë¹„ìŠ¤ ìœ„ì¹˜ ë³€ê²½ ì‹œ Gateway ì¬ë°°í¬ í•„ìš”

#### **ê¶Œì¥ ì‚¬í•­** ğŸ’¡
- **ê°œë°œ/í…ŒìŠ¤íŠ¸ í™˜ê²½**: Gateway ì§ì ‘ ë¼ìš°íŒ… (ë‹¨ìˆœí•¨)
- **í”„ë¡œë•ì…˜ í™˜ê²½**: 
  - ì†Œê·œëª¨/ê³ ì • ì¸í”„ë¼ â†’ Gateway ì§ì ‘ ë¼ìš°íŒ…
  - ëŒ€ê·œëª¨/ë™ì  ìŠ¤ì¼€ì¼ë§ â†’ Kubernetes Service Discovery ë˜ëŠ” Consul

---

### **5ë‹¨ê³„: ëŒ€ì•ˆ ê³ ë ¤ì‚¬í•­**

ë§Œì•½ ë™ì  ì„œë¹„ìŠ¤ ë””ìŠ¤ì»¤ë²„ë¦¬ê°€ í•„ìš”í•˜ë‹¤ë©´:

1. **Kubernetes í™˜ê²½**
   - Kubernetes Serviceë¥¼ í†µí•œ ìë™ ë””ìŠ¤ì»¤ë²„ë¦¬
   - Eureka ë¶ˆí•„ìš”

2. **Consul ì‚¬ìš©**
   - Eurekaë³´ë‹¤ ê°€ë³ê³  ë‹¤ì–‘í•œ ê¸°ëŠ¥
   - `spring-cloud-starter-consul-discovery`

3. **Spring Cloud LoadBalancer**
   - Eureka ì—†ì´ í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ë¡œë“œ ë°¸ëŸ°ì‹±
   - ì„¤ì • ê¸°ë°˜ ì„œë¹„ìŠ¤ ëª©ë¡ ê´€ë¦¬

---

## ğŸš€ ì‹¤í–‰ ìˆœì„œ ìš”ì•½

```
1. Gateway application.yaml ìˆ˜ì • (lb:// â†’ http://)
2. Gateway build.gradleì—ì„œ Eureka ì˜ì¡´ì„± ì œê±°
3. Gateway Java ì½”ë“œì—ì„œ @EnableDiscoveryClient ì œê±°
4. ê° ì„œë¹„ìŠ¤ì—ì„œ Eureka ì„¤ì • ì œê±° (6ê°œ ì„œë¹„ìŠ¤)
5. docker-compose.yamlì—ì„œ eureka-server ì œê±°
6. server/eureka ë””ë ‰í† ë¦¬ ì‚­ì œ
7. í…ŒìŠ¤íŠ¸ ë° ê²€ì¦
```

---

ì œê°€ ì§ì ‘ ì‘ì—…ì„ ì§„í–‰í•´ë“œë¦´ê¹Œìš”? ì•„ë‹ˆë©´ íŠ¹ì • ë‹¨ê³„ë¶€í„° ì‹œì‘í•˜ê³  ì‹¶ìœ¼ì‹ ê°€ìš”?