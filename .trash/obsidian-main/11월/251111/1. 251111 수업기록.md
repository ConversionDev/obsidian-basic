- @CrossOrigin
	- 이걸로 사용해야 해
	- api searchcontroller 에 있는 거
	- ==CrossOrigin 은 서로 다른 두 개의 URL을 연결한다. origin 은 URL을 의미함.== 
	- 8080에 오는 내용의 출처는 3000이라는 이야기. 다른 번호는 안 온다고 생각하면 돼 = 보안
	- ???? 파사드페턴에서 크로스오리진을 확인함 
		![[Pasted image 20251111101741.png]]


- GPT) 나는 ==@CrossOrigin으로 8080이랑 3000을 연결했어==. 이거를 스프링 넷플릭스로 업그레이드 하고 싶어, 어떻게 해야해?
	- DB는 한 개, 그 안에 여러 개의 테이블, 여러 개의 서비스 연결 =MSA 마이크로서비스아키텍쳐 = 클라우드로 가겠다
	- 하나 서비스로 다 해결하는 것 = 매크로서비스(모놀리식)
	- 모놀리식으로 하면 클라우드서비스 사용하기 어렵고 느려질 수 있음
	-----------------
	- 현재 우리는 API서버에 다 모여있으니까 모놀리식임. 마이크로로 쪼개야 해.
	- 그 다음에 유레카에 등록하기 위해 유레카를 만들어
	- 유레카는 1개. 유레카한테 등록된 여러 개 서비스들은 인스턴스들임
	- 필요 시 서비스 개수 (접속자 수) 늘렸다 줄였다를 자동으로 함
	-----------------
	- DNS 설정: 도메인 네임 서버에 올려서 배포할 수 있음. 이제 localhost:8080 으로 URL이 뜨는 게 아니라 개인 주소가 뜨는거야
	-----------------
	- 나는 지금 유레카를 사용할거야. 로브벨런스에다가 라운드 로빈 방식으로
	-----------------
	- 도커 컴포즈: 도커가 여러개일 때
	- 도커 exec: 도커가 1개일 때
	- 도커 1개당 마이크로서비스 1개임
	-----------------
	- 스프링 클라우드 게이트웨이를 에지(맨 앞줄) 서버로 사용
	------------------
	- 스프링 빈 등록한다 = 어노테이션 걸어라
	- bean 객체: 어노테이션 있는 거. 없는거는 포조
	- @컴포넌트 @Component는 파이프라인 연결
	- @빈 @Bean : 컨피그레이션 @Configration을 연결
	- @컨피그레이션: 컨트롤러 앞에서 컨트롤러끼리 연결해줄 수 있는 공간을 의미
	- 엣지서버: 게이트웨이 있는 서버 (우리가 만들지는 않아)

#### 오늘의 목표: 에지 서버를 통해 스웨거 UI 호출
- 우리가 회사 첫 날에서 보여줘야 할 것
- 스웨거를 보면 게이트웨이를 볼 수 있다
------
- GPT 내용
	https://chatgpt.com/share/6912e3a4-f008-800f-8f88-d62720e72ab9
- 터미널 내용
	![[Pasted image 20251111173125.png]]

--------
- 이니셜라이저 설치 전에 gradle 멀티 모듈 구성해야 함
- gradle 멀티 모듈은 MSA의 기본 구조
	- api-server를 복제해서 configuration, eureka, gateway, services(안에 service 여러개 만듦) 만들고 모든 것들을 api-server 빈폴더 만들어서 다 넣기
	- secrets 빈 폴더로 하나 만들어주기
	- .git 폴더는 api-server 전체 폴더에 하나만 있어야 하니까 다른 폴더에 있는 것들 다 삭제
	- 문서형태로 있는 git 관련 문서들은 다 존재해야 함. api-server 에 넣어주기
	- 모든 폴더에 Dockerfile 넣어주기 (확장자 없는 게 확장자임) api-server(루트)에는 안 넣음(docker-compose.yaml.txt >> 이거만 있어야 해. 이게 도커들 최종 관리해주는 애)
	- 커서로 api-server 에서 열기
	---------------
	- Cursor) @Dockerfile 이 도커 파일에 오픈 jdk 21 슬림 버전 이미지를, 볼륨은 tmp 를 사용해줘. 엔트리포인트는 gateway로 해서 이 파일을 작성해줘
	---------------
	- 회사에서 사커 서비스를 만들라고 해도 커먼 서비스랑 유저 서비스는 서비스로 감싸서 같이 만들어줘야 하는거야.
	---------------
- 도커를 채우고 합쳐
	- Cursor) @docker-compose.yaml 여기에 @Dockerfile @Dockerfile @Dockerfile @Dockerfile @Dockerfile @Dockerfile 이것들을 한번에 실행하는 코드를 작성해서
	- *나중에 서비스를 추가하면, 루트 yaml 에 도커 추가해달라고 해야해.
	- Cursor) @docker-compose.yaml 여기에 환경변수로 SERVER_PORT를 넣어줘
	- 각 폴더마다 빌드그래들 의존성들 바꿔주기 (강사님 엑스에 있긴 함)
		- 컨피그
			implementation group: '[http://org.springframework.cloud](https://t.co/V8WVst7jlU)', name: 'spring-cloud-config-server', version: '4.1.3' implementation group: 'org.springframework.boot', name: 'spring-boot-starter-actuator', version: '3.3.4' testImplementation 'org.springframework.boot:spring-boot-starter-test' testRuntimeOnly 'org.junit.platform:junit-platform-launcher' implementation '[http://org.springframework.cloud](https://t.co/V8WVst7jlU):spring-cloud-config-server' implementation 'org.springframework.boot:spring-boot-starter-actuator'
		- 유레카
			implementation group: '[http://org.springframework.cloud](https://t.co/V8WVst7Rbs)', name: 'spring-cloud-starter-netflix-eureka-server', version: '4.1.3' implementation group: '[http://org.springframework.cloud](https://t.co/V8WVst7Rbs)', name: 'spring-cloud-config', version: '4.1.3' testImplementation 'org.springframework.boot:spring-boot-starter-test' testRuntimeOnly 'org.junit.platform:junit-platform-launcher'
		- 게이트웨이
			// spring security implementation group: 'org.springframework.boot', name: 'spring-boot-starter-security', version: '3.3.4' implementation group: 'org.springframework.boot', name: 'spring-boot-starter-oauth2-client', version: '3.3.4' // spring webflux //implementation group: 'org.springframework.boot', name: 'spring-boot-starter-webflux', version: '3.3.4' // spring cloud implementation group: '[http://org.springframework.cloud](https://t.co/V8WVst7Rbs)', name: 'spring-cloud-starter-gateway', version: '4.0.0' implementation group: '[http://org.springframework.cloud](https://t.co/V8WVst7Rbs)', name: 'spring-cloud-starter-circuitbreaker-reactor-resilience4j', version: '3.1.2' // JWT implementation 'io.jsonwebtoken:jjwt-api:0.12.6' runtimeOnly 'io.jsonwebtoken:jjwt-impl:0.12.6' runtimeOnly 'io.jsonwebtoken:jjwt-jackson:0.12.6' // prometheus implementation group: 'io.micrometer', name: 'micrometer-registry-prometheus', version: '1.13.4' // spring doc implementation group: 'org.springdoc', name: 'springdoc-openapi-starter-webflux-ui', version: '2.6.0' // config implementation group: '[http://org.springframework.cloud](https://t.co/V8WVst7Rbs)', name: 'spring-cloud-config', version: '4.1.3' // mongo implementation 'org.springframework.boot:spring-boot-starter-data-mongodb-reactive' // lombok compileOnly 'org.projectlombok:lombok' annotationProcessor 'org.projectlombok:lombok' testImplementation 'org.springframework.boot:spring-boot-starter-test' testImplementation 'io.projectreactor:reactor-test' testImplementation '[http://org.springframework.security](https://t.co/snp7cVHaqn):spring-security-test' testRuntimeOnly 'org.junit.platform:junit-platform-launcher' implementation '[http://org.springframework.cloud](https://t.co/V8WVst7Rbs):spring-cloud-starter-config' implementation 'org.springframework.boot:spring-boot-starter-actuator' implementation '[http://org.springframework.cloud](https://t.co/V8WVst7Rbs):spring-cloud-starter-netflix-eureka-client'
		- 마이크로서비스
			implementation 'com.querydsl:querydsl-jpa:5.0.0:jakarta' annotationProcessor 'com.querydsl:querydsl-apt:5.0.0:jakarta' annotationProcessor 'jakarta.annotation:jakarta.annotation-api' annotationProcessor 'jakarta.persistence:jakarta.persistence-api' implementation 'jakarta.servlet:jakarta.servlet-api:6.0.0' // Spring Boot 스타터 implementation 'org.springframework.boot:spring-boot-starter-data-jdbc' implementation 'org.springframework.boot:spring-boot-starter-data-jpa' implementation 'org.springframework.boot:spring-boot-starter-web' implementation 'org.seleniumhq.selenium:selenium-java:4.19.1' implementation 'org.seleniumhq.selenium:selenium-chrome-driver:4.19.1' implementation 'com.querydsl:querydsl-jpa:5.0.0:jakarta' annotationProcessor "com.querydsl:querydsl-apt:${dependencyManagement.importedProperties['querydsl.version']}:jakarta" annotationProcessor "jakarta.annotation:jakarta.annotation-api" annotationProcessor "jakarta.persistence:jakarta.persistence-api" implementation 'org.jsoup:jsoup:1.15.3' implementation '[http://org.springframework.cloud](https://t.co/V8WVst7Rbs):spring-cloud-starter-config' implementation 'org.springframework.boot:spring-boot-starter-actuator' implementation '[http://org.springframework.cloud](https://t.co/V8WVst7Rbs):spring-cloud-starter-netflix-eureka-client' compileOnly 'org.projectlombok:lombok' annotationProcessor 'org.projectlombok:lombok' // Spring Boot DevTools developmentOnly 'org.springframework.boot:spring-boot-devtools' runtimeOnly 'com.mysql:mysql-connector-j' annotationProcessor 'org.projectlombok:lombok' testImplementation 'org.springframework.boot:spring-boot-starter-test' testRuntimeOnly 'org.junit.platform:junit-platform-launcher:1.9.3' testImplementation 'org.junit.jupiter:junit-jupiter-api:5.9.3' testRuntimeOnly 'org.junit.jupiter:junit-jupiter-engine:5.9.3' // Swagger 설정을 위한 Springdoc OpenAPI implementation 'org.springdoc:springdoc-openapi-starter-webmvc-ui:2.0.2' implementation "org.jetbrains.kotlin:kotlin-stdlib-jdk8" testRuntimeOnly 'org.junit.platform:junit-platform-launcher:1.9.3' // junit 최종버전 testImplementation 'org.junit.jupiter:junit-jupiter-api:5.9.3' // JUnit Jupiter API testRuntimeOnly 'org.junit.jupiter:junit-jupiter-engine:5.9.3' // JUnit Jupiter Engine // selenium 라이브러리 (동적 사이트) //implementation 'org.seleniumhq.selenium:selenium-java:4.1.2' implementation group: 'org.seleniumhq.selenium', name: 'selenium-java', version: '4.19.1' implementation 'org.seleniumhq.selenium:selenium-java:4.19.1' implementation 'org.seleniumhq.selenium:selenium-chrome-driver:4.19.1' implementation 'io.github.bonigarcia:webdrivermanager:5.3.0' //영수증 인식 OCR을 위한 JSON 파싱 implementation 'com.googlecode.json-simple:json-simple:1.1.1' // 클라우드 스토리지 사용을 위한 AWS SDK S3 implementation 'com.amazonaws:aws-java-sdk-s3:1.12.300' implementation 'javax.xml.bind:jaxb-api:2.3.1' implementation 'org.json:json:20211205'
		- 루트 그레들
			testImplementation 'org.springframework.boot:spring-boot-starter-test'testRuntimeOnly 'org.junit.platform:junit-platform-launcher'
--------------------
- 관리자 터미널 열기
	- ssh-keygen -t ed25519 -C "dpthf001107@gmail.com"
		- *rsa는 업데이트 전 버전으로 프라이빗키가 매우 긴 형태임*
		- *ed25519가 업데이트 된 버전으로 프라이빗 키가 짧아짐 (속도 빨라짐)
	- 쭉 엔터 누르기 (비번 없이 진행한다는건데, 나중에 개인 노트북은 비번 설정 해)
	- 완료되면 이렇게 출력됩니다 👇
		Your identification has been saved in C:\Users\hi\.ssh\id_ed25519
		Your public key has been saved in C:\Users\hi\.ssh\id_ed25519.pub
	- 공개키 내용 확인
		- cat ~/.ssh/id_ed25519.pub
			- *뒤에 pub 붙은 게 공개키, 안 붙은게 프라이빗키*
				![[Pasted image 20251111173401.png]]
	- 공개키는 레파지토리 아래 사진처럼 등록 
			![[Pasted image 20251111174359.png]]![[Pasted image 20251112095056.png]]
	- 비공개키 내용 확인
		- cat ~/.ssh/id_ed25519
	- 비공개 키를 cursor - configration(config) - application.yaml에 프라이빗 키에 넣기
	- 깃허브 레파지토리에 뉴로 새로 만들어서 HTTP를 SSH로 바꾼 후 URL 만들어서
	- 컨피그로 커서 컨피그에 주소 넣어주기 12번줄
		![[Pasted image 20251111182635.png]]


- config에 있는 yaml은 그대로 남겨두고, eureka/gateway/services에 있는 yaml은 지움
- secrets 폴더에 삭제한 yaml을 삭제한 것과 동일한 이름으로 파일 만들기
- 새로 만든 야물에는 일단 아무 말이나 넣어주고 아래 프롬프트 넣어줘
	- *컨피그에 있는 Cursor) @application.yaml 여기에서 @application.yaml (19-20) 이 비밀키 부분을 .env파일에서 호출하도록 해줘 
	- *>> 이게 안되어서
- 직접 .env 파일을 루트쪽에 만들고, 컨피그 야물에 있는 프라이빗 키를 긁어서 붙여넣음.  " "로 감싸서.
		![[Pasted image 20251111182825.png]]
- 위위 사진에서 18번 라인에 있던 프라이빗 키 다 지운 상태였고, 사진처럼 수정해
- gitignore에서 .env를 빼달라고 해
- 그다음에 깃에 레파지토리 api-server 기존꺼 지우고, 같은 이름으로 만들어서 다시 업로드 하기
- 




		- 

		- 터미널 삭제하고 싶으면 
			- cd ~/.ssh
			- del id_rsa*
			- del id_ed25519*
			- ![[Pasted image 20251111173904.png]]
			- 

깃허브의 보안 레파지토리에 스프링유레카에 컨피그 서버에 설정하는 방법을 알려줘
- 깃허브에서 레파지토리 하나 만들어서 
	![[Pasted image 20251111171052.png]]

--------
- p.409 구성 중앙화
	- 클래스 이름 = 디스커버리
	- 