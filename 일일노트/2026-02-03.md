- 이벤트버튼을 트리거로해서 누르면 규칙이 임베딩 정책으로 감
- 버튼 한번 누르면 계속 임베딩화 될 때 까지 지 알아서 돌아가도록 해야함
- ![[Pasted image 20260203094837.png]]
- 트리거가 들어가는 부분 : next에서 처리함(BullMQ)
- upstash : 토큰 가지고 있으면서 유효시간 잡아줌
- 그래서 둘이 같이 감.
- bullMQ가 트리거로 임베딩 명령을 백엔드 라우터(soccer_router.py)에게 
  배치 작업을 지시하기위해 연결된 UPSTASH_REDIS_REST_URL 에 UPSTASH_REDIS_REST_TOKEN 이 유효한 동안은 임베딩작업을 지속하도록 하는 코드를 작성해줘
- 버튼을 눌렀을때 , 각각의 테이블이 임베딩 눌렀을때 값이 네온 DB 들어가면됨 
- 로그인, 배치작업 토큰 : 레디스의 일
- 마운트(mount) = 한 `웹 서버`(메인 앱)에 다른 ASGI/웹 앱을 특정 URL 경로에 붙여서, 그 `경로로 오는 요청을 그 앱이 처리`하게 하는 것.
- 메인 앱 = 건물 한 채(서버 하나).
- 마운트 = 그 건물 안에 “/mcp-soccer 호실”, “/mcp-soccer-spoke 호실”을 두고, 그 주소로 들어오는 일은 각 호실(서브 앱)이 맡게 하는 것.
- 주소(포트)는 하나, 경로(path) 로만 구분.
- 이 자체는 구조 규칙기반, 업무 자체는 서비스에 코딩 추가한 모델은 있는거 그대로 옮기니까 규칙
- 데이터 접속 들어가는게 스포크 밑 repository(망) - 정책
- 모듈러가 구조적으로 MSA
- api src가 몇개 있냐
- 파이썬 app이 몇개 있냐
- 동기 invoke 실시간, 비동기 batch